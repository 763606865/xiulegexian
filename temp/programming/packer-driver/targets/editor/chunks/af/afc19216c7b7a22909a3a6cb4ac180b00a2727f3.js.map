{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Cocos/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/sdk/wxGame.ts"],"names":["_decorator","Component","director","sys","em","ggConfig","ggd","glf","ccclass","property","WX_GAME","_videoAd","_bannerAd","_curAdIndex","onLoad","isOpenAd","add","showWxVideoAd","bind","showBanner","hideBanner","platform","Platform","WECHAT_GAME","addPersistRootNode","node","init","console","log","wx","showShareMenu","withShareTicket","menus","initRewardAd","initBannerAd","createBannerAd","adUnitId","style","left","top","getSystemInfoSync","screenHeight","width","screenWidth","onError","err","errCode","dispatch","show","hide","createRewardedVideoAd","afterPlayAdError","onClose","res","isEnded","undefined","afterPlayAdComplete","initRewardAdByPlayTimes","index","getIndexByPlayTimes","adUnitIds","playAdTimes","catch","load","then"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, director, sys } from 'cc';\r\nimport { em } from '../global/EventManager';\r\nimport { ggConfig, ggd } from '../global/globalData';\r\nimport { glf } from '../global/globalFun';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('WX_GAME')\r\nexport class WX_GAME extends Component {\r\n\r\n    _videoAd = null;\r\n    _bannerAd = null;\r\n    _curAdIndex = 0;\r\n    onLoad() {\r\n        if (!ggd.isOpenAd) return;//没开启 直接停止初始化\r\n        em.add(\"showWxVideoAd\", this.showWxVideoAd.bind(this));\r\n        em.add(\"showBanner\", this.showBanner.bind(this));\r\n        em.add(\"hideBanner\", this.hideBanner.bind(this));\r\n        // em.add(\"initRewardAdByPlayTimes\", this.initRewardAdByPlayTimes.bind(this));\r\n        //如果是微信小游戏\r\n        if (sys.platform == sys.Platform.WECHAT_GAME) {\r\n            director.addPersistRootNode(this.node);\r\n            this.init();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description 初始化微信广告\r\n     * @errorCode  \r\n     * @code1000\t后端接口调用失败\r\n     * @code1001\t参数错误\r\n     * @code1002\t广告单元无效\r\n     * @code1003\t内部错误\r\n     * @code1004\t无合适的广告\r\n     * @code1005\t广告组件审核中\r\n     * @code1006\t广告组件被驳回\r\n     * @code1007\t广告组件被封禁\r\n     * @code1008\t广告单元已关闭\r\n    */\r\n    init() {\r\n        console.log(\"初始化微信场景\");\r\n        //初始化微信分享功能\r\n        wx.showShareMenu({\r\n            withShareTicket: true,\r\n            menus: ['shareAppMessage', 'shareTimeline']\r\n        })\r\n        // this.initBannerAd();\r\n        // this.initRewardAdByPlayTimes();\r\n        this.initRewardAd();\r\n    }\r\n    initBannerAd() {\r\n        // 创建 Banner 广告实例，提前初始化\r\n        // let gap = (wx.getSystemInfoSync().screenWidth - 200) / 2;\r\n        this._bannerAd = wx.createBannerAd({\r\n            adUnitId: 'adunit-fa354a32215cecf4',\r\n            style: {\r\n                left: 0,\r\n                top: wx.getSystemInfoSync().screenHeight - 100,\r\n                // bottom:0,\r\n                width: wx.getSystemInfoSync().screenWidth\r\n            }\r\n        });\r\n        this._bannerAd.onLoad(() => {\r\n            console.log('banner 广告加载成功');\r\n        })\r\n        this._bannerAd.onError(err => {\r\n            console.log(err)\r\n            switch (err.errCode) {\r\n                case 1000:\r\n                    console.log(\"后端接口调用失败\");\r\n                    em.dispatch(\"tipsViewShow\", \"后端接口调用失败\");\r\n                    break;\r\n                case 1001:\r\n                    console.log(\"参数错误\");\r\n                    em.dispatch(\"tipsViewShow\", \"参数错误\");\r\n                    break;\r\n                case 1002:\r\n                    console.log(\"广告单元无效\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告单元无效\");\r\n                    break;\r\n                case 1003:\r\n                    console.log(\"内部错误\");\r\n                    em.dispatch(\"tipsViewShow\", \"内部错误\");\r\n                    break;\r\n                case 1004:\r\n                    console.log(\"无合适的广告\");\r\n                    em.dispatch(\"tipsViewShow\", \"无合适的广告\");\r\n                    break;\r\n                case 1005:\r\n                    console.log(\"广告组件审核中\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件审核中\");\r\n                    break;\r\n                case 1006:\r\n                    console.log(\"广告组件被驳回\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件被驳回\");\r\n                    break;\r\n                case 1007:\r\n                    console.log(\"广告组件被封禁\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件被封禁\");\r\n                    break;\r\n                case 1008:\r\n                    console.log(\"广告单元已关闭\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告单元已关闭\");\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n\r\n        this._bannerAd.show();\r\n    }\r\n    // 在适合的场景显示 Banner 广告\r\n    showBanner() {\r\n        if (this._bannerAd) this._bannerAd.show();\r\n    }\r\n    hideBanner() {\r\n        if (this._bannerAd) this._bannerAd.hide();\r\n    }\r\n    //直接初始化 进初始化一次\r\n    initRewardAd() {\r\n        // 创建激励视频广告实例，提前初始化\r\n        this._videoAd = wx.createRewardedVideoAd({\r\n            adUnitId: \"adunit-4fd8f9b38c4adb1f\",\r\n        });\r\n\r\n        this._videoAd.onLoad(() => {\r\n            console.log('激励视频 广告加载成功')\r\n        });\r\n        this._videoAd.onError(err => {\r\n            console.log(err)\r\n            switch (err.errCode) {\r\n                case 1000:\r\n                    console.log(\"后端接口调用失败\");\r\n                    em.dispatch(\"tipsViewShow\", \"后端接口调用失败\");\r\n                    break;\r\n                case 1001:\r\n                    console.log(\"参数错误\");\r\n                    em.dispatch(\"tipsViewShow\", \"参数错误\");\r\n                    break;\r\n                case 1002:\r\n                    console.log(\"广告单元无效\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告单元无效\");\r\n                    break;\r\n                case 1003:\r\n                    console.log(\"内部错误\");\r\n                    em.dispatch(\"tipsViewShow\", \"内部错误\");\r\n                    break;\r\n                case 1004:\r\n                    console.log(\"无合适的广告\");\r\n                    em.dispatch(\"tipsViewShow\", \"无合适的广告\");\r\n                    break;\r\n                case 1005:\r\n                    console.log(\"广告组件审核中\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件审核中\");\r\n                    break;\r\n                case 1006:\r\n                    console.log(\"广告组件被驳回\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件被驳回\");\r\n                    break;\r\n                case 1007:\r\n                    console.log(\"广告组件被封禁\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件被封禁\");\r\n                    break;\r\n                case 1008:\r\n                    console.log(\"广告单元已关闭\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告单元已关闭\");\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            glf.afterPlayAdError();\r\n        })\r\n\r\n        this._videoAd.onClose(res => {\r\n            // 用户点击了【关闭广告】按钮\r\n            // 小于 2.1.0 的基础库版本，res 是一个 undefined\r\n            if (res && res.isEnded || res === undefined) {\r\n                // 正常播放结束，可以下发游戏奖励\r\n                glf.afterPlayAdComplete();\r\n            }\r\n            else {\r\n                // 播放中途退出，不下发游戏奖励\r\n                console.log(\"播放中途退出，不下发游戏奖励\");/*  */\r\n                glf.afterPlayAdError();\r\n            }\r\n        });\r\n    }\r\n    //通过播放次数初始化广告\r\n    initRewardAdByPlayTimes() {\r\n        let index = this.getIndexByPlayTimes();\r\n        let adUnitId = ggConfig.adUnitIds[index];\r\n\r\n        // 创建激励视频广告实例，提前初始化\r\n        this._videoAd = wx.createRewardedVideoAd({\r\n            adUnitId: adUnitId\r\n        });\r\n\r\n        this._videoAd.onLoad(() => {\r\n            console.log('激励视频 广告加载成功')\r\n        });\r\n        this._videoAd.onError(err => {\r\n            console.log(err)\r\n            switch (err.errCode) {\r\n                case 1000:\r\n                    console.log(\"后端接口调用失败\");\r\n                    em.dispatch(\"tipsViewShow\", \"后端接口调用失败\");\r\n                    break;\r\n                case 1001:\r\n                    console.log(\"参数错误\");\r\n                    em.dispatch(\"tipsViewShow\", \"参数错误\");\r\n                    break;\r\n                case 1002:\r\n                    console.log(\"广告单元无效\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告单元无效\");\r\n                    break;\r\n                case 1003:\r\n                    console.log(\"内部错误\");\r\n                    em.dispatch(\"tipsViewShow\", \"内部错误\");\r\n                    break;\r\n                case 1004:\r\n                    console.log(\"无合适的广告\");\r\n                    em.dispatch(\"tipsViewShow\", \"无合适的广告\");\r\n                    break;\r\n                case 1005:\r\n                    console.log(\"广告组件审核中\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件审核中\");\r\n                    break;\r\n                case 1006:\r\n                    console.log(\"广告组件被驳回\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件被驳回\");\r\n                    break;\r\n                case 1007:\r\n                    console.log(\"广告组件被封禁\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告组件被封禁\");\r\n                    break;\r\n                case 1008:\r\n                    console.log(\"广告单元已关闭\");\r\n                    em.dispatch(\"tipsViewShow\", \"广告单元已关闭\");\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            glf.afterPlayAdError();\r\n        })\r\n\r\n        this._videoAd.onClose(res => {\r\n            // 用户点击了【关闭广告】按钮\r\n            // 小于 2.1.0 的基础库版本，res 是一个 undefined\r\n            if (res && res.isEnded || res === undefined) {\r\n                ggd.playAdTimes++;\r\n                let index = this.getIndexByPlayTimes();\r\n                if (index !== this._curAdIndex) this.initRewardAdByPlayTimes();\r\n                // 正常播放结束，可以下发游戏奖励\r\n                glf.afterPlayAdComplete();\r\n            }\r\n            else {\r\n                // 播放中途退出，不下发游戏奖励\r\n                console.log(\"播放中途退出，不下发游戏奖励\");/*  */\r\n                glf.afterPlayAdError();\r\n            }\r\n        });\r\n    }\r\n    // 通过播放次数获得下标\r\n    getIndexByPlayTimes() {\r\n        let index = 0;\r\n        if (ggd.playAdTimes > 3) index = 1;\r\n        if (ggd.playAdTimes > 6) index = 2;\r\n        return index;\r\n    }\r\n\r\n    // 展示视频广告\r\n    showWxVideoAd() {\r\n        // 用户触发广告后，显示激励视频广告\r\n        this._videoAd.show().catch(() => {\r\n            // 失败重试\r\n            this._videoAd.load()\r\n                .then(() => this._videoAd.show())\r\n                .catch(err => {\r\n                    console.log('激励视频 广告显示失败')\r\n                });\r\n        });\r\n\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}