{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/mainMenu/GetsControl.ts"],"names":["_decorator","Component","find","NodePool","Label","Sprite","Color","em","plm","ccclass","property","GetsControl","_showList","onDestroy","remove","onLoad","add","showGets","bind","closeGets","getsItemPrefab","node","addPoolToPools","items","active","content","len","key","showPosList","count","Object","prototype","hasOwnProperty","call","total","data","dispatch","prefab","getFromPool","parent","sprite","getComponent","loadUrl","assets","spriteFrame","color","getColorStrByQuality","quality","label","getChildByName","string","name","pos","setPosition","children","length","child","removeFromParent","putToPool"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AAC5DC,MAAAA,E,iBAAAA,E;;AACAC,MAAAA,G,iBAAAA,G;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;;6BAGjBW,W,WADZF,OAAO,CAAC,aAAD,C,gBAAR,MACaE,WADb,SACiCV,SADjC,CAC2C;AAAA;AAAA;AAAA,eAEvCW,SAFuC,GAE3B;AACR,eAAG,CAAC,CAAC,CAAD,EAAI,CAAJ,CAAD,CADK;AAER,eAAG,CAAC,CAAC,CAAC,EAAF,EAAM,CAAN,CAAD,EAAW,CAAC,EAAD,EAAK,CAAL,CAAX,CAFK;AAGR,eAAG,CAAC,CAAC,CAAC,GAAF,EAAO,CAAP,CAAD,EAAY,CAAC,CAAD,EAAI,CAAJ,CAAZ,EAAoB,CAAC,GAAD,EAAM,CAAN,CAApB,CAHK;AAIR,eAAG,CAAC,CAAC,CAAC,GAAF,EAAO,CAAP,CAAD,EAAY,CAAC,CAAC,EAAF,EAAM,CAAN,CAAZ,EAAsB,CAAC,EAAD,EAAK,CAAL,CAAtB,EAA+B,CAAC,GAAD,EAAM,CAAN,CAA/B,CAJK;AAKR,eAAG,CAAC,CAAC,CAAC,GAAF,EAAO,EAAP,CAAD,EAAa,CAAC,CAAC,EAAF,EAAM,EAAN,CAAb,EAAwB,CAAC,EAAD,EAAK,EAAL,CAAxB,EAAkC,CAAC,GAAD,EAAM,EAAN,CAAlC,EAA6C,CAAC,CAAC,GAAF,EAAO,CAAC,EAAR,CAA7C,CALK;AAMR,eAAG,CAAC,CAAC,CAAC,GAAF,EAAO,EAAP,CAAD,EAAa,CAAC,CAAC,EAAF,EAAM,EAAN,CAAb,EAAwB,CAAC,EAAD,EAAK,EAAL,CAAxB,EAAkC,CAAC,GAAD,EAAM,EAAN,CAAlC,EAA6C,CAAC,CAAC,GAAF,EAAO,CAAC,EAAR,CAA7C,EAA0D,CAAC,CAAC,EAAF,EAAM,CAAC,EAAP,CAA1D,CANK;AAOR,eAAG,CAAC,CAAC,CAAC,GAAF,EAAO,EAAP,CAAD,EAAa,CAAC,CAAC,EAAF,EAAM,EAAN,CAAb,EAAwB,CAAC,EAAD,EAAK,EAAL,CAAxB,EAAkC,CAAC,GAAD,EAAM,EAAN,CAAlC,EAA6C,CAAC,CAAC,GAAF,EAAO,CAAC,EAAR,CAA7C,EAA0D,CAAC,CAAC,EAAF,EAAM,CAAC,EAAP,CAA1D,EAAsE,CAAC,EAAD,EAAK,CAAC,EAAN,CAAtE,CAPK;AAQR,eAAG,CAAC,CAAC,CAAC,GAAF,EAAO,EAAP,CAAD,EAAa,CAAC,CAAC,EAAF,EAAM,EAAN,CAAb,EAAwB,CAAC,EAAD,EAAK,EAAL,CAAxB,EAAkC,CAAC,GAAD,EAAM,EAAN,CAAlC,EAA6C,CAAC,CAAC,GAAF,EAAO,CAAC,EAAR,CAA7C,EAA0D,CAAC,CAAC,EAAF,EAAM,CAAC,EAAP,CAA1D,EAAsE,CAAC,EAAD,EAAK,CAAC,EAAN,CAAtE,EAAiF,CAAC,GAAD,EAAM,CAAC,EAAP,CAAjF;AARK,WAF2B;AAAA;;AAavCC,QAAAA,SAAS,GAAG;AACR;AAAA;AAAA,wBAAGC,MAAH,CAAU,UAAV;AACA;AAAA;AAAA,wBAAGA,MAAH,CAAU,WAAV;AACH;;AACDC,QAAAA,MAAM,GAAG;AACL;AAAA;AAAA,wBAAGC,GAAH,CAAO,UAAP,EAAmB,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAnB;AACA;AAAA;AAAA,wBAAGF,GAAH,CAAO,WAAP,EAAoB,KAAKG,SAAL,CAAeD,IAAf,CAAoB,IAApB,CAApB;AACA,cAAIE,cAAc,GAAGlB,IAAI,CAAC,aAAD,EAAgB,KAAKmB,IAArB,CAAzB;AACA;AAAA;AAAA,0BAAIC,cAAJ,CAAmB,mBAAnB,EAAwC,IAAInB,QAAJ,EAAxC,EAAwDiB,cAAxD;AACH,SAtBsC,CAuBvC;;;AACAH,QAAAA,QAAQ,CAACM,KAAD,EAAQ;AACZ,eAAKF,IAAL,CAAUG,MAAV,GAAmB,IAAnB;AACA,cAAIC,OAAO,GAAGvB,IAAI,CAAC,4BAAD,EAA+B,KAAKmB,IAApC,CAAlB;;AACA,cAAIK,GAAG,GAAG,CAAC,MAAM;AACb,gBAAIA,GAAG,GAAG,CAAV;;AACA,iBAAK,MAAMC,GAAX,IAAkBJ,KAAlB,EAAyB;AACrBG,cAAAA,GAAG;AACN;;AACD,mBAAOA,GAAP;AACH,WANS,GAAV;;AAOA,cAAIE,WAAW,GAAG,KAAKhB,SAAL,CAAec,GAAf,CAAlB;AACA,cAAIG,KAAK,GAAG,CAAZ;;AACA,eAAK,MAAMF,GAAX,IAAkBJ,KAAlB,EAAyB;AACrB,gBAAIO,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCV,KAArC,EAA4CI,GAA5C,CAAJ,EAAsD;AAClD,oBAAMO,KAAK,GAAGX,KAAK,CAACI,GAAD,CAAnB;AACA,kBAAIQ,IAAI,GAAG;AAAA;AAAA,4BAAGC,QAAH,CAAY,uBAAZ,EAAqCT,GAArC,CAAX,CAFkD,CAGlD;;AACA,kBAAIU,MAAM,GAAG;AAAA;AAAA,8BAAIC,WAAJ,CAAgB,mBAAhB,CAAb;AACAD,cAAAA,MAAM,CAACb,MAAP,GAAgB,IAAhB;AACAa,cAAAA,MAAM,CAACE,MAAP,GAAgBd,OAAhB;AACA,kBAAIe,MAAM,GAAGH,MAAM,CAACI,YAAP,CAAoBpC,MAApB,CAAb;AACA,kBAAIqC,OAAe,GAAGP,IAAI,CAACO,OAA3B;AACA,kBAAI,CAACP,IAAI,CAACO,OAAV,EAAmBA,OAAO,GAAG,cAAV;AACnBA,cAAAA,OAAO,GAAG,kBAAkBA,OAAlB,GAA4B,cAAtC;AACA;AAAA;AAAA,4BAAGN,QAAH,CAAY,qBAAZ,EAAmCM,OAAnC,EAA6CC,MAAD,IAAYH,MAAM,CAACI,WAAP,GAAqBD,MAA7E;AACA,kBAAIE,KAAK,GAAG,KAAKC,oBAAL,CAA0BX,IAAI,CAACY,OAA/B,CAAZ;AACA,kBAAIC,KAAK,GAAGX,MAAM,CAACY,cAAP,CAAsB,MAAtB,EAA8BR,YAA9B,CAA2CrC,KAA3C,CAAZ;AACA4C,cAAAA,KAAK,CAACH,KAAN,GAAcA,KAAd;AACA,kBAAIX,KAAK,GAAG,CAAZ,EAAec,KAAK,CAACE,MAAN,GAAef,IAAI,CAACgB,IAAL,GAAY,GAAZ,GAAkBjB,KAAjC,CAAf,KACKc,KAAK,CAACE,MAAN,GAAef,IAAI,CAACgB,IAApB;AACL,kBAAIC,GAAG,GAAGxB,WAAW,CAACC,KAAD,CAArB;AACAQ,cAAAA,MAAM,CAACgB,WAAP,CAAmBD,GAAG,CAAC,CAAD,CAAtB,EAA2BA,GAAG,CAAC,CAAD,CAA9B;AACAvB,cAAAA,KAAK;AACR;AACJ;AACJ,SA3DsC,CA4DvC;;;AACAV,QAAAA,SAAS,GAAG;AACR,eAAKE,IAAL,CAAUG,MAAV,GAAmB,KAAnB;AACA,cAAIC,OAAO,GAAGvB,IAAI,CAAC,4BAAD,EAA+B,KAAKmB,IAApC,CAAlB,CAFQ,CAGR;;AACA,iBAAOI,OAAO,CAAC6B,QAAR,CAAiBC,MAAxB,EAAgC;AAC5B,gBAAIC,KAAK,GAAG/B,OAAO,CAAC6B,QAAR,CAAiB,CAAjB,CAAZ;AACAE,YAAAA,KAAK,CAACf,YAAN,CAAmBpC,MAAnB,EAA2BuC,WAA3B,GAAyC,IAAzC;AACAY,YAAAA,KAAK,CAACC,gBAAN;AACA;AAAA;AAAA,4BAAIC,SAAJ,CAAc,mBAAd,EAAmCF,KAAnC;AACH;;AAAA;AACJ;;AACDV,QAAAA,oBAAoB,CAACC,OAAD,EAAU;AAC1B,kBAAQA,OAAR;AACI,iBAAK,CAAL;AACI,qBAAO,IAAIzC,KAAJ,CAAU,EAAV,EAAc,GAAd,EAAmB,GAAnB,CAAP;;AACJ,iBAAK,CAAL;AACI,qBAAO,IAAIA,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,CAAP;;AACJ,iBAAK,CAAL;AACI,qBAAO,IAAIA,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,CAAP;;AACJ,iBAAK,CAAL;AACI,qBAAO,IAAIA,KAAJ,CAAU,GAAV,EAAe,EAAf,EAAmB,EAAnB,CAAP;;AACJ,iBAAK,CAAL;AACI,qBAAO,IAAIA,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,EAApB,CAAP;;AACJ;AACI,qBAAO,IAAIA,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,CAAP;AAZR;AAcH,SAvFsC,CAwFvC;AACA;AACA;AACA;AACA;;;AA5FuC,O","sourcesContent":["import { _decorator, Component, Node, find, NodePool, Label, Sprite, Color } from 'cc';\r\nimport { em } from '../global/EventManager';\r\nimport { plm } from '../global/PoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GetsControl')\r\nexport class GetsControl extends Component {\r\n\r\n    _showList = {\r\n        1: [[0, 0]],\r\n        2: [[-70, 0], [70, 0]],\r\n        3: [[-170, 0], [0, 0], [170, 0]],\r\n        4: [[-210, 0], [-70, 0], [70, 0], [210, 0]],\r\n        5: [[-210, 90], [-70, 90], [70, 90], [210, 90], [-210, -65]],\r\n        6: [[-210, 90], [-70, 90], [70, 90], [210, 90], [-210, -65], [-70, -65]],\r\n        7: [[-210, 90], [-70, 90], [70, 90], [210, 90], [-210, -65], [-70, -65], [70, -65]],\r\n        8: [[-210, 90], [-70, 90], [70, 90], [210, 90], [-210, -65], [-70, -65], [70, -65], [210, -65]],\r\n    }\r\n\r\n    onDestroy() {\r\n        em.remove(\"showGets\");\r\n        em.remove(\"closeGets\");\r\n    }\r\n    onLoad() {\r\n        em.add(\"showGets\", this.showGets.bind(this));\r\n        em.add(\"closeGets\", this.closeGets.bind(this));\r\n        let getsItemPrefab = find(\"/itemPrefab\", this.node);\r\n        plm.addPoolToPools(\"SSLGetsItemPrefab\", new NodePool(), getsItemPrefab);\r\n    }\r\n    // 展示获得物品\r\n    showGets(items) {\r\n        this.node.active = true;\r\n        let content = find(\"bg/ScrollView/view/content\", this.node);\r\n        let len = (() => {\r\n            let len = 0;\r\n            for (const key in items) {\r\n                len++;\r\n            }\r\n            return len;\r\n        })();\r\n        let showPosList = this._showList[len];\r\n        let count = 0;\r\n        for (const key in items) {\r\n            if (Object.prototype.hasOwnProperty.call(items, key)) {\r\n                const total = items[key];\r\n                let data = em.dispatch(\"getItemDataByIdOrName\", key);\r\n                // let prefab = instantiate(itemPrefab);\r\n                let prefab = plm.getFromPool(\"SSLGetsItemPrefab\");\r\n                prefab.active = true;\r\n                prefab.parent = content;\r\n                let sprite = prefab.getComponent(Sprite);\r\n                let loadUrl: string = data.loadUrl;\r\n                if (!data.loadUrl) loadUrl = \"item_default\";\r\n                loadUrl = \"images/items/\" + loadUrl + \"/spriteFrame\";\r\n                em.dispatch(\"loadTheDirResources\", loadUrl, (assets) => sprite.spriteFrame = assets);\r\n                let color = this.getColorStrByQuality(data.quality);\r\n                let label = prefab.getChildByName(\"name\").getComponent(Label);\r\n                label.color = color;\r\n                if (total > 1) label.string = data.name + \"x\" + total;\r\n                else label.string = data.name;\r\n                let pos = showPosList[count];\r\n                prefab.setPosition(pos[0], pos[1]);\r\n                count++;\r\n            }\r\n        }\r\n    }\r\n    // 关闭展示获得物品界面\r\n    closeGets() {\r\n        this.node.active = false;\r\n        let content = find(\"bg/ScrollView/view/content\", this.node);\r\n        // 清空物品\r\n        while (content.children.length) {\r\n            let child = content.children[0];\r\n            child.getComponent(Sprite).spriteFrame = null;\r\n            child.removeFromParent();\r\n            plm.putToPool(\"SSLGetsItemPrefab\", child);\r\n        };\r\n    }\r\n    getColorStrByQuality(quality) {\r\n        switch (quality) {\r\n            case 1:\r\n                return new Color(89, 154, 101);\r\n            case 2:\r\n                return new Color(114, 140, 199);\r\n            case 3:\r\n                return new Color(164, 116, 207);\r\n            case 4:\r\n                return new Color(198, 92, 55);\r\n            case 5:\r\n                return new Color(227, 161, 90);\r\n            default:\r\n                return new Color(255, 255, 255);\r\n        }\r\n    }\r\n    // getColorStrByQuality(index) {\r\n    //     index > 4 ? 4 : index;\r\n    //     return [\"<color=#599A65>\", \"<color=#728CC7>\", \"<color=#A474CF>\", \"<color=#C65C37>\", \"<color=#DDA75A>\"][index];\r\n    //     // return [\"<color=#7EFFA7>\",\"<color=#7EEAFF>\",\"<color=#837EFF>\",\"<color=#FFB77E>\",\"<color=#FFE000>\"][index];\r\n    // }\r\n}\r\n\r\n\r\n"]}