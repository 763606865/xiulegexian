{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/HeroControl.ts"],"names":["_decorator","Component","Sprite","input","Input","Node","find","JsonAsset","Label","Animation","game","Color","PhysicsSystem2D","EPhysics2DDrawFlags","BoxCollider2D","Rect","Collider2D","view","instantiate","Prefab","Material","em","ggd","tagData","LevelManager","glf","ccclass","property","HeroControl","_flyingThunderGodCount","_flyingThunderGodMark","_spriteAnim","_heroData","_expData","_curDirection","x","y","_curAimDir","_canMove","_LM","_WM","_baseBlood","_bonusBlood","_curBlood","_baseMoveSpeed","_bonusMoveSpeed","_baseDamage","_bonusDamage","_criticalHitRate","_bonusCriticalHitRate","_bonusCriticalHitDamage","_bonusBulletTotal","_bonusBulletMoveSpeed","_bonusBulletDuration","_bonusBulletAttackTimes","_bonusBackDis","_recoveryHealthy","_expAddition","_divineStoneAddition","_damageReduce","_slowResistance","_continueSlowPer","_moveSpeedTimes","_changeHeroMoveSpeedCountdown","_tempCriticalHitRate","_tempPercentageDamage","_isDamageImmunity","_percentageDamage","_percentageBlood","_percentageMoveSpeed","_bonusPercentageDamage","_bonusPercentageBlood","_bonusPercentageMoveSpeed","_effectList","_trackDisappearCountdown","_shieldList","_maxShield","_curShield","_openAutoScript","_deBuffList","_touchMoveId","_touchShotId","_heroPuppet","_canRebirthByAdTimes","_gameRunTimer","onDestroy","remove","off","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","onLoad","add","getHeroWorldPos","bind","getTargetWorldPos","usingHeroControlFun","getHeroControlProperty","rebirthHero","closeRebirthAd","on","initHeroData","initComponents","initOutScripts","schedule","continueRecoveryHealthy","createRandomSkill","stopAll","activeEffects","total","Math","random","loadUrl","posArr","i","pos","dispatch","assets","prefab","itemInPlaying","parent","setPosition","getComponent","spriteFrame","init","randomSkillReward","start","showViewInfo","console","log","getVisibleSize","openPhysicalDraw","instance","enable","debugDrawFlags","Aabb","Pair","CenterOfMass","Joint","Shape","heroPropertyDataJson","json","initExpData","initHeroDataByLv","updateBloodProgress","expDataJson","obj","length","lvDescription","string","level","a","effectList","slowResistance","damageReduce","slowPer","blood","moveSpeed","baseDamage","CHR","CHD","bonusCHD","bonusBulletTotal","bonusMoveSpeed","bonusBulletAttackTimes","bonusBackDis","getMaxBlood","getHeroPropertiesDes","bB","bMS","bD","bCHR","pB","pD","pMS","boB","boMS","boD","boCHR","bPB","bPMS","bPD","tCHR","tPD","cB","cS","cD","getCurDamage","cMS","getCurMoveSpeed","cCHR","getCurCHR","node","update","deltaTime","heroMoveControl","x1","y1","x2","y2","cos","sqrt","angle","acos","PI","curDirPar","t","dir","speed","result","isCollideObs","position","obsArr","curPos","heroSprite","getWorldPosition","collider","rect","worldAABB","width","height","obs","obsPos","getTwoPointDistance","rectIsIntersectsRect","pos1","pos2","rect1","rect2","intersects","changeMoveState","bool","e","id","getID","undefined","heroMoveByTouchStart","heroShotByTouchStart","heroMoveByTouchMove","heroShotByTouchMove","heroMoveByTouchEnd","heroShotByTouchEnd","recoveryTouchRawState","setDirByTouchOffset","offset","abs","rate","setScale","value","ceil","sp","touch","getStartLocation","cp","getLocation","updateShotDirByTouch","getLocationX","getLocationY","param","hasOwnProperty","pauseGame","pause","resumeGame","passA","active","resume","getRandomPosNearbyHero","dis","wp","getRandomPosNearHero","updatePercentageBloodProgress","percentage","changeValue","updateShieldProgress","isOpenAd","showRebirthAd","showGameOver","bloodSprite","fillRange","makeBloodFull","onBtnPlayAds","curAdRewardType","playAd","scheduleOnce","shieldSprite","openShield","type","isUsingSword","stop","updateExpProgress","exp","res","addExp","selectUpgradeReward","getExpProgress","expProgress","GameUILayer","isPlayHeroAnim","createBossDamageTex","damage","restartGame","restart","updateBonusValue","lv","bonusContent","config","value2","openDamageImmunity","ejectFormObs","ejectDis","seekTreeFirstEnemyDir","tree","retrieve","targetPos","getTwoPointFlyDir","seekTreeRandomNEnemyDir","n","arr","index","push","seekTreeNEnemyPos","seekTreeRandomOneEnemyPos","banMove","msV","slow","percent","msP","msSV","d1","d2","dp","dTotal","parseInt","toFixed","isCriticalHit","getCurCriticalHitDamage","addDebuffBanMove","fun","unschedule","addDebuffSlow","v","p","time","addDebuffSlowCallFun","changeHeroMoveSpeed","times","changeHeroMoveSpeedCountdownRun","updateTempCriticalHitRate","updateBonusCriticalHitRate","updateTempPercentageDamage","updateBonusMoveSpeed","isOpenCollectGas","isOpenLikeSpringBreeze","isOpenThunderGodPower","isOpenSnowEffect","usingSkillTrackDisappear","play","trackDisappearSchedule","getChildByName","color","usingSkillLionRoar","all","skillData","forEach","script","getDistanceToHero","monsterIsRepelled","addDebuffTimid","duration","usingSkillIceShield","damageTimes","usingSkillMoveLikeShadow","setWorldPosition","resetHeroPuppet","usingSkillFlyingThunderGod","flyingThunderGodPrefab","resetFlyingThunderGodCount","destroy","indexOf","activeEffect5010","activeEffect5006","switchMaterial","count","material","heroMaterial","warn","openHangupTest"],"mappings":"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","sourcesContent":["// 英雄死亡\r\nimport { _decorator, Component, Sprite, input, Input, Node, find, js, JsonAsset, Label, Animation, game, Game, Color, PhysicsSystem2D, EPhysics2DDrawFlags, BoxCollider2D, ParticleSystem, ParticleSystem2D, Rect, Collider2D, Touch, math, view, instantiate, Prefab, macro, native, JavaScript, Material } from 'cc';\r\nimport { em } from '../global/EventManager';\r\nimport { ggd, tagData } from '../global/globalData';\r\nimport { LevelManager } from \"../system/LevelManager\";\r\nimport { glf } from '../global/globalFun';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('HeroControl')\r\nexport class HeroControl extends Component {\r\n    @property(Sprite)\r\n    bloodSprite;\r\n    @property(Sprite)\r\n    shieldSprite;\r\n    @property(Node)\r\n    heroSprite;\r\n    @property(Sprite)\r\n    expProgress;\r\n    @property(JsonAsset)\r\n    expDataJson;\r\n    @property(JsonAsset)\r\n    heroPropertyDataJson;\r\n    @property(Label)\r\n    lvDescription;\r\n    @property(Node)\r\n    GameUILayer;\r\n    @property(Prefab)\r\n    itemInPlaying;\r\n    @property(Node)\r\n    curDirPar;\r\n    @property(Prefab)\r\n    flyingThunderGodPrefab;\r\n    @property([Material])\r\n    heroMaterial = [];\r\n\r\n    _flyingThunderGodCount: number = 0;//飞雷神计数\r\n    _flyingThunderGodMark;//分类神标记\r\n\r\n    _spriteAnim;\r\n\r\n    _heroData: any;\r\n    _expData: any;\r\n    _curDirection: { x: number, y: number } = { x: 1, y: 0 };\r\n    _curAimDir: { x: number, y: number } = { x: 1, y: 0 };\r\n    _canMove = false;\r\n    _LM: LevelManager;\r\n    //外部脚本\r\n    _WM: any;\r\n\r\n    _baseBlood: number;\r\n    _bonusBlood: number;\r\n    _curBlood: number;\r\n\r\n    _baseMoveSpeed: number;\r\n    _bonusMoveSpeed: number;\r\n    _baseDamage: number;\r\n    _bonusDamage: number;\r\n\r\n    _criticalHitRate: number;//暴击率\r\n    _bonusCriticalHitRate: number;\r\n    _bonusCriticalHitDamage: number;//额外爆伤（除自身暴击伤害外的额外暴击伤害）  暴击伤害 =  1+爆伤\r\n    _bonusBulletTotal: number = 0;\r\n    _bonusBulletMoveSpeed: number = 0;\r\n    _bonusBulletDuration: number = 0;\r\n    _bonusBulletAttackTimes: number = 0;\r\n    _bonusBackDis: number = 0;//额外击退距离\r\n    _recoveryHealthy: number = 0;\r\n    _expAddition: number = 0;\r\n    _divineStoneAddition: number = 0;\r\n    //词条提供\r\n    _damageReduce: number = 0;//减伤\r\n    _slowResistance: number = 0;//减速抗性\r\n    _continueSlowPer: number = 0;//持续减速效果 不受时间影响\r\n\r\n    _moveSpeedTimes: number = 1;\r\n    _changeHeroMoveSpeedCountdown: number = 0;\r\n\r\n    _tempCriticalHitRate: number = 0;//临时暴击率 通过技能 药物 等提升 \r\n    _tempPercentageDamage: number = 0;//临时百分比伤害 通过技能或药物等提升 \r\n\r\n    _isDamageImmunity = false;//伤害免疫\r\n\r\n    //百分比属性\r\n    _percentageDamage: number;\r\n    _percentageBlood: number;\r\n    _percentageMoveSpeed: number;\r\n\r\n    // 额外百分比属性\r\n    _bonusPercentageDamage: number;\r\n    _bonusPercentageBlood: number;\r\n    _bonusPercentageMoveSpeed: number;\r\n\r\n    _effectList: number[];//技能词条列表\r\n    //技能相关\r\n    _trackDisappearCountdown = 0;//迷踪步倒计时\r\n    //护盾相关\r\n    _shieldList = {\r\n        \"iceShield\": false,//冰盾术\r\n        \"effect5006\": false,//重甲之魂\r\n    }\r\n    _maxShield: number = 0;\r\n    _curShield: number = 0;\r\n\r\n    //自动化脚本\r\n    _openAutoScript: boolean = false;\r\n\r\n    //debuff清单\r\n    _deBuffList = {\r\n        \"banMove\": false,\r\n        \"slow\": {//减速比率 减速数值 减速时间\r\n            \"percent\": 0,\r\n            \"value\": 0,\r\n            \"time\": 0,\r\n        }\r\n    }\r\n\r\n    //双触\r\n    _touchMoveId: number;\r\n    _touchShotId: number;\r\n\r\n    //傀儡\r\n    _heroPuppet = null;\r\n\r\n    _canRebirthByAdTimes = 1;\r\n\r\n    _gameRunTimer: number = 0;\r\n\r\n    onDestroy() {\r\n        em.remove(\"getHeroWorldPos\");\r\n        em.remove(\"getTargetWorldPos\");\r\n        em.remove(\"usingHeroControlFun\");\r\n        em.remove(\"getHeroControlProperty\");\r\n        em.remove(\"rebirthHero\");\r\n        em.remove(\"closeRebirthAd\");\r\n        input.off(Input.EventType.TOUCH_START, this.touchStart, this);\r\n        input.off(Input.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        input.off(Input.EventType.TOUCH_END, this.touchEnd, this);\r\n    }\r\n    onLoad() {\r\n\r\n        // this.openPhysicalDraw();\r\n        // this.showViewInfo();\r\n\r\n        em.add(\"getHeroWorldPos\", this.getHeroWorldPos.bind(this));\r\n        em.add(\"getTargetWorldPos\", this.getTargetWorldPos.bind(this));\r\n        em.add(\"usingHeroControlFun\", this.usingHeroControlFun.bind(this));\r\n        em.add(\"getHeroControlProperty\", this.getHeroControlProperty.bind(this));\r\n        em.add(\"rebirthHero\", this.rebirthHero.bind(this));\r\n        em.add(\"closeRebirthAd\", this.closeRebirthAd.bind(this));\r\n        input.on(Input.EventType.TOUCH_START, this.touchStart, this);\r\n        input.on(Input.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        input.on(Input.EventType.TOUCH_END, this.touchEnd, this);\r\n        this.initHeroData();\r\n        this.initComponents();\r\n        this.initOutScripts();\r\n        this._curDirection = { x: 0, y: 0 };\r\n        this.schedule(this.continueRecoveryHealthy, 1);\r\n        this.createRandomSkill();\r\n        //游戏运行计时器开始计时\r\n        this.schedule(() => {\r\n            if (ggd.stopAll) return;\r\n            this._gameRunTimer++;\r\n            this.activeEffects();\r\n        }, 1);\r\n    }\r\n\r\n    createRandomSkill() {\r\n        let total = 1 + Math.random() * 5 | 0;\r\n        let loadUrl = \"images/items/skillBook/spriteFrame\";\r\n        let posArr = [\r\n            { x: -500, y: 0 }, { x: 500, y: 0 }, { x: 0, y: 500 }, { x: 0, y: 500 },\r\n            { x: -500, y: 500 }, { x: 500, y: 500 }, { x: -500, y: -500 }, { x: 500, y: -500 },\r\n        ]\r\n        for (let i = 0; i < total; i++) {\r\n            let pos = posArr[i];\r\n            em.dispatch(\"loadTheDirResources\", loadUrl, assets => {\r\n                let prefab = instantiate(this.itemInPlaying);\r\n                prefab.parent = find(\"Canvas/bulletLayer\");\r\n                prefab.setPosition(pos.x, pos.y, 0);\r\n                prefab.getComponent(Sprite).spriteFrame = assets;\r\n                prefab.getComponent(\"ItemInPlaying\").init(tagData.randomSkillReward);\r\n            });\r\n        }\r\n    }\r\n    start() {\r\n        //    this.schedule(()=>{\r\n        //      // 找到距离自己最近的单位\r\n        //      let tree = em.dispatch(\"getCurMonsterQuadtree\");\r\n        //      let collider = this.node.getChildByName(\"sprite\").getComponent(BoxCollider2D);\r\n        //      let rect = collider.worldAABB;\r\n        //      let res = tree.retrieve(rect);\r\n        //      console.log(\"查询结果\",res);\r\n        //    },1);\r\n    }\r\n    showViewInfo() {\r\n        console.log(\"view\", view);\r\n        console.log(\"getVisibleSize\", view.getVisibleSize());\r\n    }\r\n    openPhysicalDraw() {\r\n        PhysicsSystem2D.instance.enable = true;\r\n        PhysicsSystem2D.instance.debugDrawFlags = EPhysics2DDrawFlags.Aabb |\r\n            EPhysics2DDrawFlags.Pair |\r\n            EPhysics2DDrawFlags.CenterOfMass |\r\n            EPhysics2DDrawFlags.Joint |\r\n            EPhysics2DDrawFlags.Shape;\r\n    }\r\n    // 初始化玩家数据\r\n    initHeroData() {\r\n        this._heroData = this.heroPropertyDataJson.json[0];//0 为当前的 后期配置hero data list  通过id 索引 获取配置\r\n        this.initExpData();\r\n        this.initHeroDataByLv();\r\n        this.updateBloodProgress(0);//用于初次刷新血条\r\n\r\n    }\r\n    // 初始化经验数据 和 等级\r\n    initExpData() {\r\n        this._expData = this.expDataJson.json;\r\n        let obj = {\r\n            \"level\": 1,\r\n            \"maxLevel\": this._expData.length,\r\n            \"curExp\": 0,\r\n            \"levelMappingExpList\": this._expData,\r\n        };\r\n        this._LM = new LevelManager(obj);\r\n        this.lvDescription.string = \"LV:\" + this._LM.level;\r\n    }\r\n    /**\r\n     * @description: 属性包括基础属性和额外属性 \r\n     */\r\n    initHeroDataByLv() {\r\n        let a = em.dispatch(\"usingHeroBasePropertyFun\", \"getBasePropertyValueByEqu\");\r\n        this._effectList = a.effectList;\r\n        console.log(\"hero data\", this._heroData);\r\n        this._slowResistance = a.slowResistance;\r\n        this._slowResistance > 1 ? 1 : this._slowResistance;\r\n        this._damageReduce = a.damageReduce;\r\n        this._continueSlowPer = a.slowPer;\r\n        this._baseBlood = em.dispatch(\"usingHeroBasePropertyFun\", \"getTrainingData\", \"blood\") + a.blood;\r\n        this._baseMoveSpeed = em.dispatch(\"usingHeroBasePropertyFun\", \"getTrainingData\", \"moveSpeed\") + a.moveSpeed;;\r\n        // this._baseMoveSpeed += 500;\r\n\r\n        this._baseMoveSpeed += em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"moveSpeed\");\r\n        // this._isDamageImmunity = true;\r\n        this._baseDamage = em.dispatch(\"usingHeroBasePropertyFun\", \"getTrainingData\", \"damage\") + a.baseDamage;\r\n\r\n        this._percentageBlood = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"percentageBlood\");\r\n        this._percentageDamage = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"percentageDamage\");\r\n        this._percentageMoveSpeed = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"percentageMoveSpeed\");\r\n        this._percentageMoveSpeed = 0;//暂时移除百分比移速加成\r\n        this._criticalHitRate = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"criticalHitRate\") + a.CHR;\r\n        this._bonusCriticalHitDamage = a.CHD + a.bonusCHD;//爆伤\r\n\r\n        this._bonusBulletTotal = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"bonusBulletTotal\");\r\n        this._bonusBulletTotal = a.bonusBulletTotal;//额外法宝数量\r\n        this._bonusBulletMoveSpeed = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"bonusBulletMoveSpeed\") + a.bonusMoveSpeed;\r\n        this._bonusBulletDuration = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"bonusBulletDuration\");\r\n        this._bonusBulletAttackTimes = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"bonusBulletAttackTimes\") + a.bonusBulletAttackTimes;\r\n        this._bonusBackDis = a.bonusBackDis;\r\n        this._recoveryHealthy = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"recoveryHealthy\");\r\n        this._expAddition = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"expAddition\") / 100;\r\n        this._divineStoneAddition = em.dispatch(\"usingHeroBasePropertyFun\", \"getHeroBaseProperty\", \"divineStoneAddition\") / 100;//灵石加成 暂未开发\r\n\r\n        this._bonusBlood = 0;\r\n        this._bonusMoveSpeed = 0;\r\n        this._bonusDamage = 0;\r\n        this._bonusCriticalHitRate = 0;\r\n        // this._bonusCriticalHitRate = 100;\r\n\r\n        this._bonusPercentageBlood = 0;\r\n        this._bonusPercentageMoveSpeed = 0;\r\n        this._bonusPercentageDamage = 0;\r\n\r\n        this._curBlood = this.getMaxBlood();\r\n        this.updateBloodProgress(0);\r\n    }\r\n    //获取角色属性描述\r\n    getHeroPropertiesDes() {\r\n        // let string = \"==============英雄属性==============\\n\";\r\n        let string = \"英雄属性:\\n\";\r\n        let bB = \"基础血量：\" + this._baseBlood + \"\\n\";\r\n        let bMS = \"基础移速：\" + this._baseMoveSpeed + \"\\n\";\r\n        let bD = \"基础伤害：\" + this._baseDamage + \"\\n\";\r\n        let bCHR = \"基础暴击率：\" + this._criticalHitRate + \"\\n\";\r\n        let pB = \"血量百分比加成：\" + this._percentageBlood + \"\\n\";\r\n        let pD = \"伤害百分比加成：\" + this._percentageDamage + \"\\n\";\r\n        let pMS = \"移速百分比加成：\" + this._percentageMoveSpeed + \"\\n\";\r\n        let boB = \"额外血量：\" + this._bonusBlood + \"\\n\";\r\n        let boMS = \"额外移速：\" + this._bonusMoveSpeed + \"\\n\";\r\n        let boD = \"额外伤害：\" + this._bonusDamage + \"\\n\";\r\n        let boCHR = \"额外暴击率：\" + this._bonusCriticalHitRate + \"\\n\";\r\n        let bPB = \"额外血量百分比加成：\" + this._bonusPercentageBlood + \"\\n\";\r\n        let bPMS = \"额外移速百分比加成：\" + this._bonusPercentageMoveSpeed + \"\\n\";\r\n        let bPD = \"额外伤害百分比加成：\" + this._bonusPercentageDamage + \"\\n\";\r\n        let tCHR = \"临时暴击率：\" + this._tempCriticalHitRate + \"\\n\";\r\n        let tPD = \"临时百分比加成：\" + this._tempPercentageDamage + \"\\n\";\r\n        let cB = \"当前血量：\" + this._curBlood + \"/\" + this.getMaxBlood() + \"\\n\";\r\n        let cS = \"当前护盾：\" + this._curShield + \"\\n\";\r\n        let cD = \"当前伤害：\" + this.getCurDamage() + \"\\n\";\r\n        let cMS = \"当前移速：\" + this.getCurMoveSpeed() + \"\\n\";\r\n        let cCHR = \"当前暴击率：\" + this.getCurCHR() + \"\\n\";\r\n        // string += bB + bMS + bD + bCHR + pB + pD + pMS + boB + boMS + boD + boCHR + bPB + bPMS + bPD+tCHR;\r\n        string += cB + cS + cD + cMS + cCHR + bB + bMS + bD + bCHR + tPD + pB + pD + pMS + boB + boMS + boD + boCHR + bPB + bPMS + bPD + tCHR;\r\n        return string;\r\n    }\r\n    //初始化组件\r\n    initComponents() {\r\n        this._spriteAnim = find(\"sprite\", this.node).getComponent(Animation);\r\n    }\r\n    // 初始化外部脚本\r\n    initOutScripts() {\r\n        this._WM = find(\"weapon\", this.node).getComponent(\"WeaponManager\");\r\n    }\r\n    update(deltaTime: number) {\r\n        this.heroMoveControl(deltaTime);\r\n        let x1 = -1;\r\n        let y1 = 0;\r\n        let x2 = this._curDirection.x;\r\n        let y2 = this._curDirection.y;\r\n        let cos = (x1 * x2 + y1 * y2) / (Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2));\r\n        let angle = Math.acos(cos) / Math.PI * 180;\r\n        if (this._curDirection.y > 0) angle = 360 - angle;\r\n        this.curDirPar.angle = angle;\r\n        // console.log(\"hero world Pos\",this.heroSprite.getWorldPosition());\r\n\r\n    }\r\n    //角色移动\r\n    heroMoveControl(t: number) {\r\n        if (!this._canMove) return;\r\n        if (ggd.stopAll) return;\r\n        let dir = this._curDirection;\r\n        em.dispatch(\"usingMapLayerFun\", \"updateMap\", dir);//刷新地图\r\n        let speed = this.getCurMoveSpeed();\r\n        let result = this.isCollideObs(dir.x * t * speed, dir.y * t * speed);\r\n        if (result) {\r\n            this.node.setPosition(this.node.position.x + result.x, this.node.position.y + result.y);\r\n            return;\r\n        }\r\n        this.node.setPosition(this.node.position.x + dir.x * t * speed, this.node.position.y + dir.y * t * speed);\r\n    }\r\n    isCollideObs(x: number, y: number) {\r\n        let obsArr = em.dispatch(\"usingMapLayerFun\", \"getAllObs\");\r\n        let curPos = this.heroSprite.getWorldPosition();\r\n        let collider = this.heroSprite.getComponent(Collider2D);\r\n\r\n        // return false;\r\n        let rect = new Rect(collider.worldAABB.x + x, collider.worldAABB.y + y, collider.worldAABB.width, collider.worldAABB.height);\r\n        for (const obs of obsArr) {\r\n            let obsPos = obs.node.getWorldPosition();\r\n            if (this.getTwoPointDistance(curPos, obsPos > 300)) continue;//距离超过300的障碍物直接忽略  多此一举？\r\n            else {\r\n                if (this.rectIsIntersectsRect(rect, obs.worldAABB)) {\r\n                    if (x !== 0 && y !== 0) {\r\n                        rect = new Rect(collider.worldAABB.x + x, collider.worldAABB.y, collider.worldAABB.width, collider.worldAABB.height);\r\n                        if (!this.rectIsIntersectsRect(rect, obs.worldAABB)) return { x: x, y: 0 };\r\n                        rect = new Rect(collider.worldAABB.x, collider.worldAABB.y + y, collider.worldAABB.width, collider.worldAABB.height);\r\n                        if (!this.rectIsIntersectsRect(rect, obs.worldAABB)) return { x: 0, y: y };\r\n                        else return false;//卡在两个墙挂角方向\r\n                    } else if (x === 0 && y !== 0) {\r\n                        rect = new Rect(collider.worldAABB.x, collider.worldAABB.y + y, collider.worldAABB.width, collider.worldAABB.height);\r\n                        if (!this.rectIsIntersectsRect(rect, obs.worldAABB)) return { x: 0, y: y };\r\n                    } else if (x !== 0 && y === 0) {\r\n                        rect = new Rect(collider.worldAABB.x + x, collider.worldAABB.y, collider.worldAABB.width, collider.worldAABB.height);\r\n                        if (!this.rectIsIntersectsRect(rect, obs.worldAABB)) return { x: x, y: 0 };\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    //获取两点的距离\r\n    getTwoPointDistance(pos1, pos2) {\r\n        let x = pos1.x - pos2.x;\r\n        let y = pos1.y - pos2.y;\r\n        return Math.sqrt(x * x + y * y);\r\n    }\r\n    //判断矩形是否相交\r\n    rectIsIntersectsRect(rect1, rect2) {\r\n        return rect1.intersects(rect2);\r\n    }\r\n    //改变changeMove状态 外部调用\r\n    changeMoveState(bool: boolean) {\r\n        this._canMove = bool;\r\n    }\r\n    /**\r\n     * @description: 优先给移动id 和 射击id 分配值\r\n     * 如果都有值，在根据值判断是移动 还是 射击\r\n     * @param {Touch} e\r\n     */\r\n    touchStart(e) {\r\n        if (ggd.stopAll) return;\r\n        let id = e.getID();\r\n        if (this._touchMoveId === undefined) {\r\n            this._touchMoveId = id;\r\n            this.heroMoveByTouchStart();\r\n        }\r\n        else if (this._touchShotId == undefined) {\r\n            this._touchShotId = id;\r\n            this.heroShotByTouchStart(e);\r\n        }\r\n        else if (this._touchMoveId === id) this.heroMoveByTouchStart();\r\n        else if (this._touchShotId === id) this.heroShotByTouchStart(e);\r\n        else {\r\n            console.log(\"暂未处理的第三次触摸 start\");\r\n        }\r\n    }\r\n    touchMove(e) {\r\n        if (ggd.stopAll) return;\r\n        let id = e.getID();\r\n        if (id === this._touchMoveId) this.heroMoveByTouchMove(e);\r\n        else if (id === this._touchShotId) this.heroShotByTouchMove(e);\r\n        else {\r\n            console.log(\"暂未处理的第三次触摸 move\");\r\n        }\r\n    }\r\n    touchEnd(e) {\r\n        let id = e.getID();\r\n        if (id === this._touchMoveId) this.heroMoveByTouchEnd();\r\n        else if (id === this._touchShotId) this.heroShotByTouchEnd();\r\n        else {\r\n            console.log(\"暂未处理的第三次触摸 end\");\r\n        }\r\n    }\r\n    //恢复到点击原始状态\r\n    recoveryTouchRawState() {\r\n        this._touchMoveId = undefined;\r\n        this._touchShotId = undefined;\r\n        this._canMove = false;\r\n    }\r\n    //通过偏移设置方向\r\n    setDirByTouchOffset(offset) {\r\n        if (offset.x == 0) {\r\n            this._curDirection.x = 0;\r\n\r\n            this._curDirection.y = Math.abs(offset.y) / offset.y;\r\n        } else if (offset.y == 0) {\r\n            this._curDirection.x = Math.abs(offset.x) / offset.x;\r\n            this._curDirection.y = 0;\r\n        } else {\r\n            let rate = Math.abs(offset.x / offset.y);\r\n            if (rate >= 1) {\r\n                this._curDirection.x = Math.abs(offset.x) / offset.x;\r\n                this._curDirection.y = 1 / rate * Math.abs(offset.y) / offset.y;\r\n            } else {\r\n                this._curDirection.x = rate * Math.abs(offset.x) / offset.x;\r\n                this._curDirection.y = Math.abs(offset.y) / offset.y;\r\n            };\r\n            // console.log(\"1/rate\",1/rate);\r\n        };\r\n        // console.log(\"curDirection\",this._curDirection);\r\n        if (this._curDirection.x <= 0) this.heroSprite.setScale(1, 1, 1);\r\n        else this.heroSprite.setScale(-1, 1, 1);\r\n    }\r\n    //生命恢复函数\r\n    continueRecoveryHealthy() {\r\n        if (ggd.stopAll) return;\r\n        // console.log(\"current blood\",this._curBlood);\r\n        let value = Math.ceil(this.getMaxBlood() * this._recoveryHealthy);\r\n        this.updateBloodProgress(value);\r\n        // console.log(\"回血+\"+value);\r\n    }\r\n    //开始移动\r\n    heroMoveByTouchStart() {\r\n        this._canMove = true;\r\n    }\r\n    //保持移动\r\n    heroMoveByTouchMove(e) {\r\n        let sp = e.touch.getStartLocation();\r\n        let cp = e.touch.getLocation();\r\n        let offset: any = {};\r\n        offset.x = cp.x - sp.x;\r\n        offset.y = cp.y - sp.y;\r\n        if (0 == offset.x && 0 == offset.y) return;//点击未发生偏移 不需要处理\r\n        this.setDirByTouchOffset(offset);\r\n    }\r\n    //结束移动\r\n    heroMoveByTouchEnd() {\r\n        this._canMove = false;\r\n        this._touchMoveId = undefined;\r\n    }\r\n    // 开始射击\r\n    heroShotByTouchStart(e) {\r\n        console.log(\"射击开始\");\r\n        this.updateShotDirByTouch(e);\r\n        // this._curAimDir = twp.\r\n\r\n        // em.dispatch(\"createTipsTex\",\"射击开始\");\r\n    }\r\n    // 保持射击\r\n    heroShotByTouchMove(e) {\r\n        console.log(\"保持射击\");\r\n        this.updateShotDirByTouch(e);\r\n        // em.dispatch(\"createTipsTex\",\"保持射击\");\r\n    }\r\n    // 结束射击\r\n    heroShotByTouchEnd() {\r\n        console.log(\"射击结束\");\r\n        // em.dispatch(\"createTipsTex\",\"射击结束\");\r\n        this._touchShotId = undefined;\r\n    }\r\n    updateShotDirByTouch(e) {\r\n        // Touch\r\n        // let twp = e.getLocation();\r\n        // let hwp = this.getHeroWorldPos();\r\n        // let x = twp.x - hwp.x;\r\n        // let y = twp.y - hwp.y;\r\n        let rect = view.getVisibleSize();\r\n        let x = e.getLocationX() - rect.width / 2;\r\n        let y = e.getLocationY() - rect.height / 2;\r\n        if (x === 0 && y === 0) {\r\n            this._curAimDir.x = 1;\r\n            this._curAimDir.y = 0;\r\n        } else if (x === 0) {\r\n            this._curAimDir.x = 0;\r\n            this._curAimDir.y = Math.abs(y) / y;\r\n        } else if (y === 0) {\r\n            this._curAimDir.x = Math.abs(x) / x;\r\n            this._curAimDir.y = 0;\r\n        } else if (Math.abs(x) >= Math.abs(y)) {\r\n            this._curAimDir.x = Math.abs(x) / x;\r\n            this._curAimDir.y = y / Math.abs(x);\r\n        } else {\r\n            this._curAimDir.x = x / Math.abs(y);\r\n            this._curAimDir.y = Math.abs(y) / y;\r\n        }\r\n        console.log(\"shotDir\", this._curAimDir);\r\n        console.log(\"x\", x);\r\n        console.log(\"y\", y);\r\n    }\r\n    //==================================外部调用======================================================\r\n    //使用hero control 方法\r\n    usingHeroControlFun(string, ...param) {\r\n        if (this[string] && typeof this[string] == \"function\") return this[string](...param);\r\n        else throw string + \" is not fun or undefined\";\r\n    }\r\n    //获取hero control 属性\r\n    getHeroControlProperty(string: string) {\r\n        if (this.hasOwnProperty(string)) return this[string];\r\n        else throw \"hero control 中不存在属性：\" + string;\r\n    }\r\n    // 暂停游戏\r\n    pauseGame() {\r\n        this._spriteAnim.pause();\r\n        ggd.stopAll = true;\r\n        em.dispatch(\"usingMonsterManagerFun\", \"pauseAllAnim\");\r\n        em.dispatch(\"usingGameAnimManagerFun\", \"pauseAllAnim\");\r\n    }\r\n    //恢复游戏\r\n    resumeGame() {\r\n        let passA = find(\"Canvas/heroLayer/GameUILayer/passRewardLayer\").active;\r\n        if (passA) {\r\n            return;\r\n        }\r\n        this._spriteAnim.resume();\r\n        ggd.stopAll = false;\r\n        em.dispatch(\"usingMonsterManagerFun\", \"resumeAllAnim\");\r\n        em.dispatch(\"usingGameAnimManagerFun\", \"resumeAllAnim\");\r\n\r\n    }\r\n    //获取hero的世界坐标  \r\n    getHeroWorldPos() {\r\n        return this.heroSprite.getWorldPosition();\r\n    }\r\n    /**\r\n     * @description 获取英雄附近一定范围内的随机坐标\r\n     * @param {number} dis 起始距离\r\n     * @param {number} offset 距离偏移量\r\n     * */\r\n    getRandomPosNearbyHero(dis, offset) {\r\n        let wp = this.heroSprite.getWorldPosition();\r\n        wp.x += ((dis + Math.random() * offset | 0) * (Math.random() > 0.5 ? 1 : -1));\r\n        wp.y += (dis + Math.random() * offset | 0 * (Math.random() > 0.5 ? 1 : -1));\r\n        return wp;\r\n    }\r\n    //获取target的世界坐标  优先返回傀儡位置信息 无傀儡在返回hero位置\r\n    getTargetWorldPos() {\r\n        if (this._heroPuppet) return this._heroPuppet.getWorldPosition();\r\n        return this.heroSprite.getWorldPosition();\r\n    }\r\n    //获取一个在hero附近的位置\r\n    getRandomPosNearHero(dis = 200) {\r\n        let wp = this.heroSprite.getWorldPosition();\r\n        let x = Math.random() * dis | 0;\r\n        let y = Math.random() * dis | 0;\r\n        x = Math.random() > 0.5 ? x : -x;\r\n        y = Math.random() > 0.5 ? y : -y;\r\n        return { x: wp.x + x, y: wp.y + y };\r\n    }\r\n    //百分比刷新血量\r\n    updatePercentageBloodProgress(percentage: number) {\r\n        let changeValue = this.getMaxBlood() * percentage;\r\n        this.updateBloodProgress(changeValue);\r\n    }\r\n    //刷新血条\r\n    updateBloodProgress(changeValue: number) {\r\n        if (ggd.stopAll) return;\r\n        if (changeValue < 0) {//受到伤害\r\n            let damageReduce = em.dispatch(\"usingSkillManagerFun\", \"getPercentageReduceDamageFromSecretSkill\") + this._damageReduce;\r\n            damageReduce > 1 ? 1 : damageReduce;\r\n            changeValue = changeValue * (1 - damageReduce) | 0;\r\n            em.dispatch(\"createDamageTex\", this.heroSprite, changeValue, { x: 0, y: 50 });\r\n            em.dispatch(\"usingSkillManagerFun\", \"updateSecretSkillTimesAfterAttacked\");//刷新被击中触发的技能层数\r\n        }\r\n        if (changeValue < 0 && this._curShield > 0) {\r\n            this.updateShieldProgress(changeValue);\r\n            return;\r\n        }\r\n        // console.log(\"刷新血条，changeValue\", changeValue);\r\n        this._curBlood += changeValue;\r\n        if (this._curBlood < 0) {\r\n            this._curBlood = 0;\r\n            this.pauseGame();\r\n            if (ggd.isOpenAd && this._canRebirthByAdTimes > 0) {\r\n                this._canRebirthByAdTimes--;\r\n                this.showRebirthAd();\r\n            } else this.showGameOver();\r\n        };\r\n        if (this._curBlood > this.getMaxBlood()) this._curBlood = this.getMaxBlood();\r\n        this.bloodSprite.fillRange = this._curBlood / this.getMaxBlood();\r\n    }\r\n    // 血量拉满\r\n    makeBloodFull() {\r\n        this._curBlood = this.getMaxBlood();\r\n        this.bloodSprite.fillRange = this._curBlood / this.getMaxBlood();\r\n    }\r\n    showRebirthAd() {\r\n        find(\"Canvas/heroLayer/GameUILayer/rebirthAd\").active = true;\r\n    }\r\n    onBtnPlayAds() {\r\n        ggd.curAdRewardType = \"rebirthHero\";\r\n        glf.playAd();\r\n        // native.reflection.callStaticMethod(\"com/cocos/game/AppActivity\", \"createAds\", \"()V\");\r\n        find(\"Canvas/heroLayer/GameUILayer/rebirthAd\").active = false;\r\n        // console.log(\"播放广告\");\r\n        // this.scheduleOnce(()=>{\r\n        //     this.rebirthHero();\r\n        // },3);\r\n    }\r\n    rebirthHero() {\r\n        console.log(\"复活玩家\");\r\n        this._isDamageImmunity = true;\r\n        this.scheduleOnce(() => {\r\n            this._isDamageImmunity = false;\r\n        }, 5);\r\n        this.makeBloodFull();\r\n        this.resumeGame();\r\n    }\r\n    closeRebirthAd() {\r\n        find(\"Canvas/heroLayer/GameUILayer/rebirthAd\").active = false;\r\n        this.showGameOver();\r\n    }\r\n\r\n    //刷新护盾\r\n    updateShieldProgress(changeValue: number) {\r\n        this._curShield += changeValue;\r\n        this._curShield = this._curShield > this._maxShield ? this._maxShield : this._curShield;\r\n        if (this._curShield > 0) {\r\n            this.shieldSprite.fillRange = this._curShield / this._maxShield;\r\n        }\r\n        else {\r\n            this._curShield = 0;\r\n            this.shieldSprite.node.parent.active = false;\r\n            changeValue -= this._curShield;\r\n            this.updateBloodProgress(changeValue);\r\n        }\r\n    }\r\n    // 开启护盾\r\n    openShield(value: number, type: string) {\r\n        if (this._shieldList[type] === false) {\r\n            this._shieldList[type] = true;\r\n            this._maxShield += value;\r\n        }\r\n        this._curShield += value;\r\n        this._curShield = this._curShield > this._maxShield ? this._maxShield : this._curShield;\r\n        this.shieldSprite.fillRange = this._curShield / this._maxShield;\r\n        this.shieldSprite.node.parent.active = true;\r\n    }\r\n\r\n    //展示游戏结束\r\n    showGameOver() {\r\n        ggd.stopAll = true;//停止一切行为\r\n        this._WM.isUsingSword(false);// 停止攻击\r\n        this._spriteAnim.stop();// 停止移动\r\n        //所有怪物放入对象池 移除之前 先停止生成\r\n        em.dispatch(\"endStage\");\r\n    }\r\n    //刷新经验/100条\r\n    updateExpProgress(exp: number) {\r\n\r\n        exp *= (1 + this._expAddition);\r\n        // exp *= (3 + this._expAddition);\r\n        let res = this._LM.addExp(exp);\r\n        if (res) {\r\n            this.lvDescription.string = \"LV:\" + this._LM.level;\r\n            this.selectUpgradeReward();\r\n            //升级后刷新最大血量 并且血量拉满\r\n            this.updateBloodProgress(0);//用于初次刷新血条\r\n        }\r\n        let fillRange = this._LM.getExpProgress();\r\n        fillRange = fillRange == undefined ? 0 : fillRange;\r\n        this.expProgress.fillRange = fillRange;\r\n    }\r\n    //选择奖励技能\r\n    selectUpgradeReward() {\r\n        this.pauseGame();\r\n        find(\"selectWeapon\", this.GameUILayer).active = true;\r\n        em.dispatch(\"updateSelectWeapon\");\r\n    }\r\n    //是否播放hero动画\r\n    isPlayHeroAnim(bool: boolean) {\r\n        if (bool) {\r\n            this._spriteAnim.resume();\r\n            console.log(\"继续播放\");\r\n        } else {\r\n            this._spriteAnim.pause();\r\n            console.log(\"停止播放\");//\r\n        }\r\n    }\r\n    //创建玩家被攻击的伤害文本\r\n    createBossDamageTex(damage: number) {\r\n        // if(em.dispatch(\"getHeroControlProperty\",\"_isDamageImmunity\")) return;\r\n        if (this._isDamageImmunity) return;\r\n        em.dispatch(\"createDamageTex\", this.node, damage, { x: 0, y: 50 });//伤害低于30不显示伤害文本\r\n        this.updateBloodProgress(damage);\r\n    }\r\n    //重新开始\r\n    restartGame() {\r\n        ggd.stopAll = false;\r\n        game.restart();\r\n    }\r\n\r\n    // 刷新额外属性（百分比提升）   注：更新血量时 需要刷新 \r\n    updateBonusValue(type, lv) {\r\n        console.log(\"刷新额外属性 ,还没写\");\r\n        let bonusContent = \"\";\r\n        let config = {\r\n            \"1\": 0.01,\r\n            \"2\": 0.02,\r\n            \"3\": 0.03,\r\n            \"4\": 0.04,\r\n            \"5\": 0.05,\r\n        };\r\n        switch (type) {\r\n            case \"blood\":\r\n                // this._bonusBlood+=config[lv];\r\n                this._bonusPercentageBlood += config[lv];\r\n                this._bonusPercentageBlood = (this._bonusPercentageBlood * 100 | 0) / 100;\r\n                let value = (this._baseBlood + this._bonusBlood) * config[lv] | 0;\r\n                this.updateBloodProgress(value);\r\n                bonusContent = \"血量+\" + config[lv] * 100 + \"%\";\r\n                break;\r\n            case \"damage\":\r\n                this._bonusPercentageDamage += config[lv];\r\n                this._bonusPercentageDamage = (this._bonusPercentageDamage * 100 | 0) / 100;\r\n                bonusContent = \"伤害+\" + config[lv] * 100 + \"%\";\r\n                break;\r\n            case \"moveSpeed\":\r\n                this._bonusPercentageMoveSpeed += config[lv];\r\n                this._bonusPercentageMoveSpeed = (this._bonusPercentageMoveSpeed * 100 | 0) / 100;\r\n                bonusContent = \"移速+\" + config[lv] * 100 + \"%\";\r\n                break;\r\n            case \"superArmor\"://增加血量和伤害\r\n                this._bonusPercentageBlood += config[lv];\r\n                this._bonusPercentageBlood = (this._bonusPercentageBlood * 100 | 0) / 100;\r\n                let value2 = (this._baseBlood + this._bonusBlood) * config[lv] | 0;\r\n                this.updateBloodProgress(value2);\r\n                bonusContent += \"血量+\" + config[lv] * 100 + \"%\";\r\n                this._bonusPercentageDamage += config[lv];\r\n                this._bonusPercentageDamage = (this._bonusPercentageDamage * 100 | 0) / 100;\r\n                bonusContent += \"伤害+\" + config[lv] * 100 + \"%\";\r\n                break;\r\n            default:\r\n                throw \"strength type is error\";\r\n        }\r\n        return bonusContent;\r\n    }\r\n    // 开启免伤\r\n    openDamageImmunity() {\r\n        this._isDamageImmunity = true;\r\n    }\r\n    // 从障碍物中弹出\r\n    ejectFormObs() {\r\n        let ejectDis = 5;\r\n        this.node.setPosition(this.node.position.x - this._curDirection.x * ejectDis, this.node.position.y - this._curDirection.y * ejectDis);\r\n        // let script:any = find(\"sprite\",this.node).getComponent(\"HeroCollider\");\r\n        // let isInside:any = script._isInsideObs;\r\n        // if(isInside) this.ejectFormObs();\r\n    }\r\n    /**\r\n     * @description 寻找玩家附近四叉树的第一个目标 \r\n     * @returns {{x,y}|null} 返回dir;\r\n    */\r\n    seekTreeFirstEnemyDir() {\r\n        let tree = em.dispatch(\"getCurMonsterQuadtree\");\r\n        let rect = this.heroSprite.getComponent(BoxCollider2D).worldAABB;\r\n        let res = tree.retrieve(rect);\r\n        // console.log(\"seekTreeFirstEnemyDir\",res);\r\n        //随机返回一个附近位置\r\n        if (res.length) {\r\n            let rect = res[0];\r\n            //四叉树位置锁定修正\r\n            let targetPos = {\r\n                x: rect.x + rect.width / 2,\r\n                y: rect.y + rect.height / 2\r\n            };\r\n            let wp = em.dispatch(\"getHeroWorldPos\");\r\n            return glf.getTwoPointFlyDir(targetPos, wp);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * @description 随机寻找附近的n个目标 随机一个rect 依次向后\r\n     * @param {number} n 获取的总数量\r\n     * @returns {Array|null} 返回dirs;\r\n    */\r\n    seekTreeRandomNEnemyDir(n) {\r\n        let tree = em.dispatch(\"getCurMonsterQuadtree\");\r\n        let rect = this.heroSprite.getComponent(BoxCollider2D).worldAABB;\r\n        let res = tree.retrieve(rect);\r\n        // console.log(\"seekTreeRandomNEnemyDir\",res);\r\n        if (res.length) {\r\n            let arr = [];\r\n            for (let i = 0; i < n; i++) {\r\n                let index = Math.random() * res.length | 0;\r\n                let rect = res[index];\r\n                let targetPos = {\r\n                    x: rect.x + rect.width / 2,\r\n                    y: rect.y + rect.height / 2\r\n                };\r\n                let wp = em.dispatch(\"getHeroWorldPos\");\r\n                let dir = glf.getTwoPointFlyDir(targetPos, wp);\r\n                arr.push(dir);\r\n            }\r\n            return arr;\r\n        } else return null;\r\n    }\r\n    // seekTreeRandomNEnemyDir(n) {\r\n    //     let tree = em.dispatch(\"getCurMonsterQuadtree\");\r\n    //     let rect = this.heroSprite.getComponent(BoxCollider2D).worldAABB;\r\n    //     let res = tree.retrieve(rect);\r\n    //     // console.log(\"seekTreeRandomNEnemyDir\",res);\r\n    //     if (res.length) {\r\n    //         let arr = [];\r\n    //         let index = Math.random() * res.length | 0;\r\n    //         for (let i = 0; i < n; i++) {\r\n    //             index = index >= res.length ? 0 : index;\r\n    //             let rect = res[index];\r\n    //             let targetPos = {\r\n    //                 x: rect.x + rect.width / 2,\r\n    //                 y: rect.y + rect.height / 2\r\n    //             };\r\n    //             let wp = em.dispatch(\"getHeroWorldPos\");\r\n    //             let dir = glf.getTwoPointFlyDir(targetPos, wp);\r\n    //             arr.push(dir);\r\n    //             index++;\r\n    //         }\r\n    //         return arr;\r\n    //     } else return null;\r\n    // }\r\n    /**\r\n     * @description 获取四叉树附近的目标位置\r\n     * @param {number} n 获取目标的总数量\r\n     * @returns {Array|null} 返回n个位置 或 null\r\n    */\r\n    seekTreeNEnemyPos(n) {\r\n        let tree = em.dispatch(\"getCurMonsterQuadtree\");\r\n        let rect = this.heroSprite.getComponent(BoxCollider2D).worldAABB;\r\n        let res = tree.retrieve(rect);\r\n        if (res.length) {\r\n            let arr = [];\r\n            let index = Math.random() * res.length | 0;\r\n            for (let i = 0; i < n; i++) {\r\n                index = index >= res.length ? 0 : index;\r\n                let rect = res[index];\r\n                let targetPos = {\r\n                    x: rect.x + rect.width / 2,\r\n                    y: rect.y + rect.height / 2\r\n                };\r\n                arr.push(targetPos);\r\n                index++;\r\n            }\r\n            return arr;\r\n        } else return null;\r\n    }\r\n    /**\r\n     * @description 随机获取四叉树中的一个目标位置\r\n     * @returns {{x,y}}|null} 返回1个位置 或 null\r\n    */\r\n    seekTreeRandomOneEnemyPos() {\r\n        let tree = em.dispatch(\"getCurMonsterQuadtree\");\r\n        let rect = this.heroSprite.getComponent(BoxCollider2D).worldAABB;\r\n        let res = tree.retrieve(rect);\r\n        //随机返回一个附近位置\r\n        if (res.length) {\r\n            let rect = res[Math.random() * res.length | 0];\r\n            //四叉树位置锁定修正\r\n            let targetPos = {\r\n                x: rect.x + rect.width / 2,\r\n                y: rect.y + rect.height / 2\r\n            };\r\n            return targetPos;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    // =====================获取当前信息===================\r\n    // 获取最大血量（满血）\r\n    getMaxBlood() {\r\n        return (this._baseBlood + this._bonusBlood) * (1 + this._bonusPercentageBlood + this._percentageBlood) | 0;\r\n    }\r\n    /**\r\n     * @description 获取当前移速\r\n     * @variation  msV 移速值\r\n     * @variation  msP 移速百分比\r\n     * @variation  msSV 秘法移速值\r\n    */\r\n    getCurMoveSpeed() {\r\n        if (this._deBuffList.banMove) return 0;\r\n        let msV = (this._baseMoveSpeed + this._bonusMoveSpeed) - this._deBuffList.slow.value * (1 - this._slowResistance);\r\n        if (msV < 0) msV = 0;\r\n        let slowPer = (this._deBuffList.slow.percent + this._continueSlowPer) * (1 - this._slowResistance);\r\n        slowPer >= 1 ? 1 : slowPer;\r\n        let msP = (this._moveSpeedTimes + this._bonusPercentageMoveSpeed + this._percentageMoveSpeed) * (1 - slowPer);\r\n        let msSV = em.dispatch(\"usingSkillManagerFun\", \"getMoveSpeedFromSecretSkill\");\r\n        // console.log(\"msV\", msV);\r\n        // console.log(\"msP\", msP);\r\n        // console.log(\"msSV\", msSV);\r\n        return (msV * msP + msSV) | 0;\r\n    }\r\n    //获取当前伤害\r\n    getCurDamage() {\r\n        let d1 = this._baseDamage + this._bonusDamage;\r\n        let d2 = em.dispatch(\"usingSkillManagerFun\", \"getDamageValueFromSecretSkill\");\r\n        let dp = em.dispatch(\"usingSkillManagerFun\", \"getPercentageDamageFromSecretSkill\");//秘法提供的加成\r\n        let dTotal = (d1 + d2) * (1 + this._bonusPercentageDamage + this._percentageDamage + dp + this._tempPercentageDamage);\r\n        // console.log(\"d1\", d1);\r\n        // console.log(\"d2\", d2);\r\n        // console.log(\"dp\", dp);\r\n        // console.log(\"percentageD\", 1 + this._bonusPercentageDamage + this._percentageDamage + dp);=\r\n        // console.log(\"dTotal\", dTotal);\r\n        return parseInt(dTotal.toFixed());\r\n    }\r\n    // 获取当前暴击率\r\n    getCurCHR() {\r\n        let total = this._criticalHitRate + this._tempCriticalHitRate + this._bonusCriticalHitRate;\r\n        total += em.dispatch(\"usingSkillManagerFun\", \"getCHRFromSecretSkill\");\r\n        return total;\r\n    }\r\n    //攻击是否暴击\r\n    isCriticalHit() {\r\n        return Math.random() * 100 < this.getCurCHR();\r\n    }\r\n    /**\r\n     * @description 获取当前暴击伤害  CRD_T = 1 + 1 + CRD  \r\n     * CRD_T 总暴击伤害 = 基础伤害 + 基础暴击伤害 + 爆伤伤害\r\n    */\r\n    getCurCriticalHitDamage() {\r\n        return 2 + this._bonusCriticalHitDamage;\r\n    }\r\n    //==================施加debuff=========================\r\n    /**\r\n     * @description: 施加debuff 禁步\r\n     */\r\n    addDebuffBanMove(t) {\r\n        console.log(\"addDebuffBanMove\");\r\n        this._deBuffList.banMove = true;\r\n        let fun = () => {\r\n            if (ggd.stopAll) return;\r\n            t--;\r\n            if (t <= 0) {\r\n                this.unschedule(fun);\r\n                this._deBuffList.banMove = false;\r\n            }\r\n        };\r\n        this.schedule(fun, 1);\r\n    }\r\n    /**\r\n     * @description: 施加debuff 减速   减速规则：时间无限叠加。数值无限叠加 ,比例无限叠加（极限为1）；\r\n     * @param {number} t  减速时长\r\n     * @param {number} v  减速数值\r\n     * @param {number} p  减速百分比\r\n     */\r\n    addDebuffSlow(t, v, p = 0) {\r\n        console.log(\"addDebuffSlow\");\r\n        em.dispatch(\"createTipsTex\", \"减速\");\r\n        this._deBuffList.slow.time = t;\r\n        this._deBuffList.slow.value += v;\r\n        this._deBuffList.slow.percent += 0;\r\n        if (this._deBuffList.slow.percent > 1) this._deBuffList.slow.percent = 1;\r\n        this.unschedule(this.addDebuffSlowCallFun);\r\n        this.schedule(this.addDebuffSlowCallFun, 1);\r\n    }\r\n    // 减速回调 新的减速会重置回调\r\n    addDebuffSlowCallFun() {\r\n        if (ggd.stopAll) return;\r\n        this._deBuffList.slow.time--;\r\n        if (this._deBuffList.slow.time <= 0) {\r\n            this.unschedule(this.addDebuffSlowCallFun);\r\n            this._deBuffList.slow.time = 0;\r\n            this._deBuffList.slow.percent = 0;\r\n            this._deBuffList.slow.value = 0;\r\n        }\r\n    }\r\n    // =====================技能相关===================\r\n    /**\r\n     * @description: 改变移速 加速或减速\r\n     * @param {*} times 速度倍率\r\n     * @param {*} t 变化时长\r\n     */\r\n    changeHeroMoveSpeed(times, t) {\r\n        this._moveSpeedTimes = times;\r\n        this._changeHeroMoveSpeedCountdown = t;\r\n        this.schedule(this.changeHeroMoveSpeedCountdownRun, 1);\r\n    }\r\n    // 改变移速倒计时\r\n    changeHeroMoveSpeedCountdownRun() {\r\n        this._changeHeroMoveSpeedCountdown--;\r\n        if (this._changeHeroMoveSpeedCountdown <= 0) {\r\n            this._moveSpeedTimes = 1;\r\n            this._changeHeroMoveSpeedCountdown = 0;\r\n        }\r\n    }\r\n\r\n    updateTempCriticalHitRate(changeValue) {\r\n        this._tempCriticalHitRate += changeValue;\r\n    }\r\n    //更新奖励暴击率\r\n    updateBonusCriticalHitRate(changeValue) {\r\n        this._bonusCriticalHitRate += changeValue;\r\n    }\r\n    // 更新临时百分比伤害\r\n    updateTempPercentageDamage(changeValue) {\r\n        this._tempPercentageDamage += changeValue;\r\n    }\r\n    //更新奖励移速\r\n    updateBonusMoveSpeed(changeValue) {\r\n        this._bonusMoveSpeed += changeValue;\r\n    }\r\n    // 凝气术 聚气\r\n    isOpenCollectGas(bool: boolean) {\r\n        find(\"effect/collectGasEffect\", this.node).active = bool;\r\n    }\r\n    // 如沐春风 聚气\r\n    isOpenLikeSpringBreeze(bool: boolean) {\r\n        find(\"effect/likeSpringBreeze\", this.node).active = bool;\r\n    }\r\n    // 雷神之力\r\n    isOpenThunderGodPower(bool: boolean) {\r\n        find(\"effect/thunderGodPower\", this.node).active = bool;\r\n    }\r\n    // 下雪\r\n    isOpenSnowEffect(bool: boolean) {\r\n        find(\"effect/snowEffect\", this.node).active = bool;\r\n    }\r\n    // 使用迷踪步\r\n    usingSkillTrackDisappear(t) {\r\n        console.log(\"usingSkillTrackDisappear\", t);\r\n\r\n        this._trackDisappearCountdown = t;\r\n        this._isDamageImmunity = true;\r\n        this._spriteAnim.play(\"trackDisappear\");\r\n        this.unschedule(this.trackDisappearSchedule);\r\n        this.schedule(this.trackDisappearSchedule, 1);\r\n        // this.scheduleOnce(() => {\r\n        //     this._isDamageImmunity = false;\r\n        //     this._spriteAnim.play(\"heroMove1\");\r\n        //     this.node.getChildByName(\"sprite\").getComponent(Sprite).color = new Color(255, 255, 255, 255);\r\n        // }, t);\r\n    }\r\n    trackDisappearSchedule() {\r\n        if (ggd.stopAll) return;\r\n        this._trackDisappearCountdown--;\r\n\r\n        if (this._trackDisappearCountdown <= 0) {\r\n            this._isDamageImmunity = false;\r\n            this._spriteAnim.play(\"heroRun\");\r\n            this.node.getChildByName(\"sprite\").getComponent(Sprite).color = new Color(255, 255, 255, 255);\r\n            this.unschedule(this.trackDisappearSchedule);\r\n        }\r\n    }\r\n    // 使用 怒狮狂吼\r\n    usingSkillLionRoar() {\r\n        let all = em.dispatch(\"usingMonsterManagerFun\", \"getAllMonsterScript\");\r\n        let skillData = em.dispatch(\"usingHeroBasePropertyFun\", \"getSkillBookDataByIdOrName\", \"怒狮狂吼\");\r\n        all.forEach(script => {\r\n            if (script.getDistanceToHero() < 300) {\r\n                script.monsterIsRepelled(150);//击退150码\r\n                script.addDebuffTimid(skillData.duration);//施加5s胆怯\r\n            }\r\n        });\r\n    }\r\n    //使用冰盾术\r\n    usingSkillIceShield() {\r\n        let skillData = em.dispatch(\"usingHeroBasePropertyFun\", \"getSkillBookDataByIdOrName\", \"iceShield\");\r\n        let value = this.getMaxBlood() * skillData.damageTimes;\r\n        this.openShield(value, \"iceShield\");\r\n    }\r\n    // 使用移形换影\r\n    usingSkillMoveLikeShadow() {\r\n        let skillData = em.dispatch(\"usingHeroBasePropertyFun\", \"getSkillBookDataByIdOrName\", \"moveLikeShadow\");\r\n        let value = this.getMaxBlood() * skillData.damageTimes;\r\n        em.dispatch(\"loadTheDirResources\", \"/prefabs/hero/weapon/moveLikeShadow\", (assets) => {\r\n            let prefab = instantiate(assets);\r\n            let wp = this.getHeroWorldPos();\r\n            prefab.parent = find(\"Canvas/puppetLayer\");\r\n            prefab.setWorldPosition(wp);\r\n            prefab.getComponent(\"MoveLikeShadow\").init(value);\r\n            this._heroPuppet = prefab;\r\n        });\r\n    }\r\n    //置空移形换影\r\n    resetHeroPuppet() {\r\n        this._heroPuppet = null;\r\n    }\r\n    // 飞雷神 \r\n    usingSkillFlyingThunderGod() {\r\n        if (this._flyingThunderGodCount % 2 == 0) {\r\n            console.log(\"留下标记\");\r\n            let prefab = instantiate(this.flyingThunderGodPrefab);\r\n            prefab.parent = find(\"Canvas/bulletLayer\");\r\n            let wp = this.getHeroWorldPos();\r\n            // prefab.setWorldPosition(wp.x,wp.y,wp.z);\r\n            prefab.setWorldPosition(wp);\r\n            this._flyingThunderGodMark = prefab;\r\n            this._flyingThunderGodCount++;\r\n        } else {\r\n            console.log(\"回到标记\");\r\n            let wp = this._flyingThunderGodMark.getWorldPosition();\r\n            this.resetFlyingThunderGodCount();\r\n            this.node.setWorldPosition(wp);\r\n        }\r\n    }\r\n    //销毁飞雷神标记\r\n    resetFlyingThunderGodCount() {\r\n        this._flyingThunderGodCount = 0;\r\n        if (!this._flyingThunderGodMark) return;\r\n        let prefab = this._flyingThunderGodMark;\r\n        this._flyingThunderGodMark = null;\r\n        prefab.destroy();\r\n    }\r\n    //=============词条相关================\r\n    // 激活词条\r\n    activeEffects() {\r\n        // if(this._effectList.indexOf(5010)>-1&&this._gameRunTimer%50 == 0) this.activeEffect5010();\r\n        if (this._effectList.indexOf(5010) > -1 && this._gameRunTimer % 50 == 0) this.activeEffect5010();\r\n        if (this._effectList.indexOf(5006) > -1 && this._gameRunTimer % 30 == 0) this.activeEffect5006();\r\n    }\r\n    //重甲之魂\r\n    activeEffect5006() {\r\n        em.dispatch(\"createTipsTex\", \"重甲之魂\");\r\n        let blood = this.getMaxBlood() * 0.2 | 0;\r\n        this.openShield(blood, \"effect5006\");\r\n    }\r\n    // 无敌风火轮\r\n    activeEffect5010() {\r\n        em.dispatch(\"createTipsTex\", \"无敌风火轮\");\r\n        this._isDamageImmunity = true;\r\n        this.switchMaterial(1);\r\n        let count = 10;\r\n        let fun = () => {\r\n            if (ggd.stopAll) return;\r\n            count--;\r\n            if (count <= 0) {\r\n                this.unschedule(fun);\r\n                this._isDamageImmunity = false;\r\n                this.switchMaterial();\r\n                em.dispatch(\"createTipsTex\", \"无敌风火轮结束\");\r\n            }\r\n        }\r\n        this.schedule(fun, 1);\r\n    }\r\n    switchMaterial(index = 0) {\r\n        switch (index) {\r\n            case 0://默认材质\r\n                this.heroSprite.getComponent(Sprite).material = this.heroMaterial[0];\r\n                break;\r\n            case 1://无敌风火轮\r\n                this.heroSprite.getComponent(Sprite).material = this.heroMaterial[1];\r\n                break;\r\n            default:\r\n                console.warn(\"不存在材质index=\" + index);\r\n                break;\r\n        }\r\n    }\r\n    //=============辅助功能================\r\n    // 挂机测试\r\n    openHangupTest() {\r\n        this._openAutoScript = true;\r\n        em.dispatch(\"usingWeaponManagerFun\", \"usingMaxLvWeapon\");//开启武器高等级\r\n        // this._isDamageImmunity = true;//开启无敌\r\n    }\r\n\r\n}\r\n\r\n"]}