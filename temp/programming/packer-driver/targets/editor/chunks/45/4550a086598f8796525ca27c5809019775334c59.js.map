{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/weapon/ThunderRunning.ts"],"names":["_decorator","em","ggd","tagData","Weapon","ccclass","property","ThunderRunning","_startP","_maxMoveDistance","_curMoveDistance","init","flyDir","_flyDir","_moveSpeed","addToAnimManger","initSkillData","p","node","getWorldPosition","x","y","data","dispatch","_damage","baseDamage","_damageTimes","damageTimes","_duration","duration","_backDis","_canAttackTimes","Infinity","_attackInterval","_weaponName","name2","initBoxCollider","sword","weaponMove","deltaTime","stopAll","wp","getPathLikeSin","setWorldPosition","Math","PI","sin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUSA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,E,iBAAAA,E;;AACgBC,MAAAA,G,iBAAAA,G;AAAKC,MAAAA,O,iBAAAA,O;;AACrBC,MAAAA,M,iBAAAA,M;;;;;;AAbT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;OAKM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;gCAGjBO,c,WADZF,OAAO,CAAC,gBAAD,C,gBAAR,MACaE,cADb;AAAA;AAAA,4BAC2C;AAAA;AAAA;AAAA,eACvCC,OADuC,GAC7B,IAD6B;AAAA,eAEvCC,gBAFuC,GAEpB,CAFoB;AAAA,eAGvCC,gBAHuC,GAGpB,CAHoB;AAAA;;AAIvCC,QAAAA,IAAI,CAACC,MAAD,EAAS;AACT,eAAKC,OAAL,GAAeD,MAAf;AACA,eAAKE,UAAL,GAAkB,GAAlB;AACA,eAAKL,gBAAL,GAAwB,IAAxB;AACA,eAAKC,gBAAL,GAAwB,CAAxB;AACA,eAAKK,eAAL;AACA,eAAKC,aAAL;AACA,cAAIC,CAAC,GAAG,KAAKC,IAAL,CAAUC,gBAAV,EAAR,CAPS,CAQT;;AAEA,eAAKX,OAAL,GAAe;AACXY,YAAAA,CAAC,EAAEH,CAAC,CAACG,CADM;AAEXC,YAAAA,CAAC,EAAEJ,CAAC,CAACI;AAFM,WAAf;AAIH;;AACDL,QAAAA,aAAa,GAAG;AACZ,cAAIM,IAAI,GAAG;AAAA;AAAA,wBAAGC,QAAH,CAAY,0BAAZ,EAAwC,4BAAxC,EAAsE,gBAAtE,CAAX;AACA,eAAKC,OAAL,GAAeF,IAAI,CAACG,UAApB;AACA,eAAKC,YAAL,GAAoBJ,IAAI,CAACK,WAAzB;AACA,eAAKC,SAAL,GAAiBN,IAAI,CAACO,QAAtB;AACA,eAAKC,QAAL,GAAgB,CAAhB;AACA,eAAKC,eAAL,GAAuBC,QAAvB;AACA,eAAKC,eAAL,GAAuB,GAAvB;AACA,eAAKC,WAAL,GAAmBZ,IAAI,CAACa,KAAxB;AACA,eAAKC,eAAL,CAAqB;AAAA;AAAA,kCAAQC,KAA7B;AACH;;AACDC,QAAAA,UAAU,CAACC,SAAD,EAAY;AAClB,cAAI;AAAA;AAAA,0BAAIC,OAAJ,IAAe,CAAC,KAAKhC,OAAzB,EAAkC;AAClC,cAAIiC,EAAE,GAAG,KAAKvB,IAAL,CAAUC,gBAAV,EAAT;;AACA,cAAI,KAAKN,OAAL,CAAaQ,CAAb,IAAkB,CAAtB,EAAyB;AACrB,gBAAID,CAAC,GAAGmB,SAAS,GAAG,KAAKzB,UAAzB;AACA,gBAAIO,CAAC,GAAG,KAAKqB,cAAL,CAAoBD,EAAE,CAACrB,CAAH,GAAOA,CAAP,GAAW,KAAKZ,OAAL,CAAaY,CAA5C,CAAR;AACA,iBAAKV,gBAAL,IAAyBU,CAAzB;AACA,iBAAKF,IAAL,CAAUyB,gBAAV,CAA2BF,EAAE,CAACrB,CAAH,GAAOA,CAAC,GAAC,KAAKP,OAAL,CAAaO,CAAjD,EAAoD,KAAKZ,OAAL,CAAaa,CAAb,GAAiBA,CAArE,EAAwE,CAAxE;AACH,WALD,MAKO;AACH,gBAAIA,CAAC,GAAGkB,SAAS,GAAG,KAAKzB,UAAzB;AACA,gBAAIM,CAAC,GAAG,KAAKsB,cAAL,CAAoBD,EAAE,CAACpB,CAAH,GAAOA,CAAP,GAAW,KAAKb,OAAL,CAAaa,CAA5C,CAAR;AACA,iBAAKX,gBAAL,IAAyBW,CAAzB;AACA,iBAAKH,IAAL,CAAUyB,gBAAV,CAA2B,KAAKnC,OAAL,CAAaY,CAAb,GAAiBA,CAA5C,EAA+CqB,EAAE,CAACpB,CAAH,GAAOA,CAAC,GAAC,KAAKR,OAAL,CAAaQ,CAArE,EAAwE,CAAxE;AACH;AACJ;;AACDqB,QAAAA,cAAc,CAACtB,CAAD,EAAI;AACdA,UAAAA,CAAC,GAAGA,CAAC,GAAGwB,IAAI,CAACC,EAAT,GAAc,GAAlB,CADc,CACQ;;AACtB,iBAAO,MAAMD,IAAI,CAACE,GAAL,CAAS1B,CAAT,CAAb;AACH;;AAhDsC,O","sourcesContent":["/*\r\n * @Author: li_jiang_wei_12345 739671694@qq.com\r\n * @Date: 2022-11-30 14:45:03\r\n * @LastEditors: li_jiang_wei_12345 739671694@qq.com\r\n * @LastEditTime: 2022-12-01 15:53:43\r\n * @FilePath: \\to-be-immortal\\assets\\script\\hero\\weapon\\ThunderRunning.ts\r\n * @Description: \r\n * \r\n * Copyright (c) 2022 by li_jiang_wei_12345 739671694@qq.com, All Rights Reserved. \r\n */\r\nimport { _decorator, Component, Node, find } from 'cc';\r\nimport { em } from '../../global/EventManager';\r\nimport { attackInterval, ggd, tagData } from '../../global/globalData';\r\nimport { Weapon } from './Weapon';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('ThunderRunning')\r\nexport class ThunderRunning extends Weapon {\r\n    _startP = null;\r\n    _maxMoveDistance = 0;\r\n    _curMoveDistance = 0;\r\n    init(flyDir) {\r\n        this._flyDir = flyDir;\r\n        this._moveSpeed = 100;\r\n        this._maxMoveDistance = 2000;\r\n        this._curMoveDistance = 0;\r\n        this.addToAnimManger();\r\n        this.initSkillData();\r\n        let p = this.node.getWorldPosition();\r\n        // let dir = em.dispatch(\"getHeroControlProperty\", \"_curAimDir\");\r\n\r\n        this._startP = {\r\n            x: p.x,\r\n            y: p.y\r\n        };\r\n    }\r\n    initSkillData() {\r\n        let data = em.dispatch(\"usingHeroBasePropertyFun\", \"getSkillBookDataByIdOrName\", \"thunderRunning\");\r\n        this._damage = data.baseDamage;\r\n        this._damageTimes = data.damageTimes;\r\n        this._duration = data.duration;\r\n        this._backDis = 0;\r\n        this._canAttackTimes = Infinity;\r\n        this._attackInterval = 0.5;\r\n        this._weaponName = data.name2;\r\n        this.initBoxCollider(tagData.sword);\r\n    }\r\n    weaponMove(deltaTime) {\r\n        if (ggd.stopAll || !this._startP) return;\r\n        let wp = this.node.getWorldPosition();\r\n        if (this._flyDir.y == 0) {\r\n            let x = deltaTime * this._moveSpeed;\r\n            let y = this.getPathLikeSin(wp.x + x - this._startP.x);\r\n            this._curMoveDistance += x;\r\n            this.node.setWorldPosition(wp.x + x*this._flyDir.x, this._startP.y + y, 0);\r\n        } else {\r\n            let y = deltaTime * this._moveSpeed;\r\n            let x = this.getPathLikeSin(wp.y + y - this._startP.y);\r\n            this._curMoveDistance += y;\r\n            this.node.setWorldPosition(this._startP.x + x, wp.y + y*this._flyDir.y, 0);\r\n        }\r\n    }\r\n    getPathLikeSin(x) {\r\n        x = x * Math.PI / 100;//每50个单位 转为π\r\n        return 100 * Math.sin(x);\r\n    }\r\n}\r\n\r\n"]}