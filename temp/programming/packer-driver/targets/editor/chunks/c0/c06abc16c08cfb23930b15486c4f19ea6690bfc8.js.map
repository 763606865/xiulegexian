{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/weapon/Guard.ts"],"names":["_decorator","em","ggd","tagData","Weapon","ccclass","Guard","init","data","lv","initWeaponInfo","weaponName","name","initCircleCollider","colliderMonster","other","stopAll","scheduleOnce","_attackInterval","isTouching","damage","dispatch","_damage","node","x","y","getComponent","updateBlood","colliderBoss","script","parent","components"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUSA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,E,iBAAAA,E;;AACAC,MAAAA,G,iBAAAA,G;AAAMC,MAAAA,O,iBAAAA,O;;AACNC,MAAAA,M,iBAAAA,M;;;;;;AAbT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;OAKM;AAAEC,QAAAA;AAAF,O,GAAcL,U;;uBAGPM,K,WADZD,OAAO,CAAC,OAAD,C,gBAAR,MACaC,KADb;AAAA;AAAA,4BACkC;AAC9B;AACAC,QAAAA,IAAI,CAACC,IAAD,EAAMC,EAAN,EAAU;AACV,eAAKC,cAAL,CAAoBD,EAApB,EAAuBD,IAAvB;AACA,cAAIG,UAAiB,GAAGH,IAAI,CAACI,IAA7B;AACA,eAAKC,kBAAL,CAAwB;AAAA;AAAA,kCAAQF,UAAR,CAAxB,EAA4C,CAAC,EAA7C;AACH,SAN6B,CAO9B;;;AACAG,QAAAA,eAAe,CAACC,KAAD,EAAQ;AACnB,cAAI;AAAA;AAAA,0BAAIC,OAAR,EAAiB;AACb,iBAAKC,YAAL,CAAkB,MAAM;AACpB,mBAAKH,eAAL,CAAqBC,KAArB;AACH,aAFD,EAEG,KAAKG,eAFR;AAGA;AACH;;AACD,cAAI,CAAC,KAAKC,UAAL,CAAgBJ,KAAhB,CAAL,EAA6B,OAPV,CAQnB;;AACA,cAAIK,MAAM,GAAG;AAAA;AAAA,wBAAGC,QAAH,CAAY,qBAAZ,EAAkC,cAAlC,IAAoD,KAAKC,OAAtE;;AACA;AAAA;AAAA,wBAAGD,QAAH,CAAY,iBAAZ,EAA+BN,KAAK,CAACQ,IAArC,EAA2CH,MAA3C,EAAmD;AAAEI,YAAAA,CAAC,EAAE,CAAL;AAAQC,YAAAA,CAAC,EAAE;AAAX,WAAnD;AACAV,UAAAA,KAAK,CAACQ,IAAN,CAAWG,YAAX,CAAwB,SAAxB,EAAmCC,WAAnC,CAA+C,CAACP,MAAhD;AACA,eAAKH,YAAL,CAAkB,MAAM;AACpB,iBAAKH,eAAL,CAAqBC,KAArB;AACH,WAFD,EAEG,KAAKG,eAFR;AAGH,SAvB6B,CAwB9B;;;AACAU,QAAAA,YAAY,CAACb,KAAD,EAAQ;AAChB,cAAI;AAAA;AAAA,0BAAIC,OAAR,EAAiB;AACb,iBAAKC,YAAL,CAAkB,MAAM;AACpB,mBAAKW,YAAL,CAAkBb,KAAlB;AACH,aAFD,EAEG,KAAKG,eAFR;AAGA;AACH;;AACD,cAAI,CAAC,KAAKC,UAAL,CAAgBJ,KAAhB,CAAL,EAA6B,OAPb,CAQhB;;AACA;AAAA;AAAA,wBAAGM,QAAH,CAAY,iBAAZ,EAA+BN,KAAK,CAACQ,IAArC,EAA2C,KAAKD,OAAhD,EAAyD;AAAEE,YAAAA,CAAC,EAAE,CAAL;AAAQC,YAAAA,CAAC,EAAE;AAAX,WAAzD,EATgB,CAUhB;;AACA,cAAII,MAAM,GAAGd,KAAK,CAACQ,IAAN,CAAWO,MAAX,CAAkBC,UAAlB,CAA6B,CAA7B,CAAb;;AACA,cAAIF,MAAJ,EAAY;AACR;AACA,gBAAIT,MAAM,GAAG;AAAA;AAAA,0BAAGC,QAAH,CAAY,qBAAZ,EAAkC,cAAlC,IAAoD,KAAKC,OAAtE;;AACAO,YAAAA,MAAM,CAACF,WAAP,CAAmB,CAACP,MAApB;AACA,iBAAKH,YAAL,CAAkB,MAAM;AACpB,mBAAKW,YAAL,CAAkBb,KAAlB;AACH,aAFD,EAEG,KAAKG,eAFR;AAGH,WAPD,MAOO,MAAM,0CAAN;AACV;;AA7C6B,O","sourcesContent":["/*\r\n * @Author: li_jiang_wei_12345 739671694@qq.com\r\n * @Date: 2022-08-22 16:29:49\r\n * @LastEditors: li_jiang_wei_12345 739671694@qq.com\r\n * @LastEditTime: 2022-11-04 10:03:45\r\n * @FilePath: \\copy9train\\assets\\script\\hero\\weapon\\Guard.ts\r\n * @Description: \r\n * \r\n * Copyright (c) 2022 by li_jiang_wei_12345 739671694@qq.com, All Rights Reserved. \r\n */\r\nimport { _decorator , Color } from 'cc';\r\nimport { em } from '../../global/EventManager';\r\nimport { ggd , tagData } from '../../global/globalData';\r\nimport { Weapon } from './Weapon';\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass('Guard')\r\nexport class Guard extends Weapon {\r\n    // _touchGuard:boolean = false;\r\n    init(data,lv) { \r\n        this.initWeaponInfo(lv,data);\r\n        let weaponName:string = data.name;\r\n        this.initCircleCollider(tagData[weaponName],-10);\r\n    }\r\n    //guard 存在多段伤害 需要攻击间隔加入判定\r\n    colliderMonster(other) {\r\n        if (ggd.stopAll) {\r\n            this.scheduleOnce(() => {\r\n                this.colliderMonster(other);\r\n            }, this._attackInterval);\r\n            return;\r\n        }\r\n        if (!this.isTouching(other)) return;\r\n        // let damage = em.dispatch(\"getHeroControlProperty\",\"_damage\") + this._damage;\r\n        let damage = em.dispatch(\"usingHeroControlFun\",\"getCurDamage\") + this._damage;\r\n        em.dispatch(\"createDamageTex\", other.node, damage, { x: 0, y: 20 });\r\n        other.node.getComponent(\"Monster\").updateBlood(-damage);\r\n        this.scheduleOnce(() => {\r\n            this.colliderMonster(other);\r\n        }, this._attackInterval);\r\n    }\r\n    //攻击怪物和boss的区别 在于击退 穿透等属性 和一些other的内部回调 暂时没写\r\n    colliderBoss(other) {\r\n        if (ggd.stopAll) {\r\n            this.scheduleOnce(() => {\r\n                this.colliderBoss(other);\r\n            }, this._attackInterval);\r\n            return;\r\n        }\r\n        if (!this.isTouching(other)) return;\r\n        //boss节点名 必须和boss 名 相同\r\n        em.dispatch(\"createDamageTex\", other.node, this._damage, { x: 0, y: 20 });\r\n        // let script = other.node.getComponent(other.node._name);\r\n        let script = other.node.parent.components[0];\r\n        if (script) {\r\n            // let damage = em.dispatch(\"getHeroControlProperty\",\"_damage\") + this._damage;\r\n            let damage = em.dispatch(\"usingHeroControlFun\",\"getCurDamage\") + this._damage;\r\n            script.updateBlood(-damage);\r\n            this.scheduleOnce(() => {\r\n                this.colliderBoss(other);\r\n            }, this._attackInterval);\r\n        } else throw \"script name is different form node name.\";\r\n    }\r\n}\r\n\r\n"]}