{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/mainMenu/MainMenu.ts"],"names":["_decorator","Component","Node","SpriteFrame","find","Sprite","Label","director","sys","JsonAsset","em","ggd","glf","ccclass","property","MainMenu","_layerNode","_SSLNode","_HILNode","_TLNode","_MPNode","_SBNode","_PHNode","_AINode","onDestroy","remove","onLoad","add","onSelectBtn","bind","push","preloadScene","versionNotice","active","gets","start","initAccountInfo","initLvInfo","initLingshiTotal","accountData","localStorage","getItem","JSON","parse","getComponent","string","account","data","dispatch","des","trainingLvListJson","json","curLv","name","total","e","p","updateBtnSF","parseInt","openLayer","index","btnArr","forEach","btn","i","spriteFrame","menuBtnSF","node","layer","onBtnAds","curAdRewardType","playAd","onBtnOpenUpgradeEquLvLayer","upgradeEquLvLayer","onBtnSignInToday"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAsBC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,G,OAAAA,G;AAAKC,MAAAA,S,OAAAA,S;;AAE7FC,MAAAA,E,iBAAAA,E;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,G,iBAAAA,G;;;;;;AAdT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;OAMM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBd,U;;0BAGjBe,Q,WADZF,OAAO,CAAC,UAAD,C,UAGHC,QAAQ,CAAC,CAACX,WAAD,CAAD,C,UAERW,QAAQ,CAAC,CAACZ,IAAD,CAAD,C,UAERY,QAAQ,CAAC,CAACX,WAAD,CAAD,C,UAERW,QAAQ,CAACL,SAAD,C,UAERK,QAAQ,CAACZ,IAAD,C,UAERY,QAAQ,CAACZ,IAAD,C,UAERY,QAAQ,CAACZ,IAAD,C,2BAfb,MACaa,QADb,SAC8Bd,SAD9B,CACwC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAiBpCe,UAjBoC,GAiBvB,EAjBuB;AAAA,eAmBpCC,QAnBoC;AAAA,eAoBpCC,QApBoC;AAAA,eAqBpCC,OArBoC;AAAA,eAsBpCC,OAtBoC;AAAA,eAuBpCC,OAvBoC;AAAA,eAwBpCC,OAxBoC;AAAA,eAyBpCC,OAzBoC;AAAA;;AA0BpCC,QAAAA,SAAS,GAAG;AACR;AAAA;AAAA,wBAAGC,MAAH,CAAU,qBAAV;AACH;;AACDC,QAAAA,MAAM,GAAG;AACL;AAAA;AAAA,wBAAGC,GAAH,CAAO,qBAAP,EAA8B,KAAKC,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB,CAA9B;AAEA,eAAKZ,QAAL,GAAgBb,IAAI,CAAC,mCAAD,CAApB;AACA,eAAKc,QAAL,GAAgBd,IAAI,CAAC,gCAAD,CAApB;AACA,eAAKe,OAAL,GAAef,IAAI,CAAC,gCAAD,CAAnB;AACA,eAAKgB,OAAL,GAAehB,IAAI,CAAC,iCAAD,CAAnB;AACA,eAAKiB,OAAL,GAAejB,IAAI,CAAC,iCAAD,CAAnB;AACA,eAAKkB,OAAL,GAAelB,IAAI,CAAC,iCAAD,CAAnB;AACA,eAAKmB,OAAL,GAAenB,IAAI,CAAC,gCAAD,CAAnB;;AAEA,eAAKY,UAAL,CAAgBc,IAAhB,CAAqB,KAAKb,QAA1B,EAAoC,KAAKC,QAAzC,EAAmD,KAAKC,OAAxD,EAAiE,KAAKC,OAAtE,EAA+E,KAAKC,OAApF,EAA6F,KAAKC,OAAlG,EAA2G,KAAKC,OAAhH;;AACA,eAAKK,WAAL,CAAiB,IAAjB,EAAuB,GAAvB;AACArB,UAAAA,QAAQ,CAACwB,YAAT,CAAsB,MAAtB,EAbK,CAcL;;AACA,eAAKC,aAAL,CAAmBC,MAAnB,GAA4B,IAA5B;AACA,eAAKD,aAAL,CAAmBC,MAAnB,GAA4B,KAA5B;AACA,eAAKC,IAAL,CAAUD,MAAV,GAAmB,IAAnB;AACA,eAAKC,IAAL,CAAUD,MAAV,GAAmB,KAAnB,CAlBK,CAoBL;AACH;;AACDE,QAAAA,KAAK,GAAG;AACJ,eAAKC,eAAL;AACA,eAAKC,UAAL;AACA,eAAKC,gBAAL,GAHI,CAIJ;AACH;;AACDF,QAAAA,eAAe,GAAG;AACd,cAAIG,WAAgB,GAAG/B,GAAG,CAACgC,YAAJ,CAAiBC,OAAjB,CAAyB,WAAzB,CAAvB;;AACA,cAAIF,WAAJ,EAAiB;AACbA,YAAAA,WAAW,GAAGG,IAAI,CAACC,KAAL,CAAWJ,WAAX,CAAd;AACAnC,YAAAA,IAAI,CAAC,gDAAD,CAAJ,CAAuDwC,YAAvD,CAAoEtC,KAApE,EAA2EuC,MAA3E,GAAoFN,WAAW,CAACO,OAAhG;AACH,WAHD,MAGO;AACH1C,YAAAA,IAAI,CAAC,gDAAD,CAAJ,CAAuDwC,YAAvD,CAAoEtC,KAApE,EAA2EuC,MAA3E,GAAoF,IAApF;AACH;AACJ;;AACDR,QAAAA,UAAU,GAAG;AACT,cAAIU,IAAI,GAAG;AAAA;AAAA,wBAAGC,QAAH,CAAY,aAAZ,EAA2B,UAA3B,CAAX,CADS,CACyC;;AAClD,cAAI,SAASD,IAAb,EAAmB;AACf3C,YAAAA,IAAI,CAAC,6CAAD,CAAJ,CAAoDwC,YAApD,CAAiEtC,KAAjE,EAAwEuC,MAAxE,GAAiF,MAAjF;AACH,WAFD,MAEO;AACH,gBAAII,GAAG,GAAG,KAAKC,kBAAL,CAAwBC,IAAxB,CAA6BJ,IAAI,CAACK,KAAlC,EAAyCC,IAAnD;AACAjD,YAAAA,IAAI,CAAC,6CAAD,CAAJ,CAAoDwC,YAApD,CAAiEtC,KAAjE,EAAwEuC,MAAxE,GAAiFI,GAAjF;AACH;AACJ;;AACDX,QAAAA,gBAAgB,GAAG;AACf,cAAIgB,KAAK,GAAG;AAAA;AAAA,wBAAGN,QAAH,CAAY,wBAAZ,EAAqC,IAArC,CAAZ;AACA5C,UAAAA,IAAI,CAAC,6CAAD,CAAJ,CAAoDwC,YAApD,CAAiEtC,KAAjE,EAAwEuC,MAAxE,GAAiFS,KAAjF;AACH;;AAID1B,QAAAA,WAAW,CAAC2B,CAAD,EAAIC,CAAJ,EAAO;AACd,eAAKC,WAAL,CAAiBC,QAAQ,CAACF,CAAD,CAAR,GAAc,CAA/B;;AACA,kBAAQA,CAAR;AACI,iBAAK,GAAL;AACI,kBAAID,CAAC,KAAK,IAAV,EAAgB;AAAA;AAAA,4BAAGP,QAAH,CAAY,aAAZ,EAA2B,cAA3B;AAChB,mBAAKW,SAAL,CAAe,KAAK1C,QAApB;AACA;;AACJ,iBAAK,GAAL;AACI,kBAAIsC,CAAC,KAAK,IAAV,EAAgB;AAAA;AAAA,4BAAGP,QAAH,CAAY,aAAZ,EAA2B,eAA3B;AAChB,mBAAKW,SAAL,CAAe,KAAKzC,QAApB;AACA;;AACJ,iBAAK,GAAL;AACI,kBAAIqC,CAAC,KAAK,IAAV,EAAgB;AAAA;AAAA,4BAAGP,QAAH,CAAY,aAAZ,EAA2B,eAA3B;AAChB,mBAAKW,SAAL,CAAe,KAAKxC,OAApB;AACA;;AACJ,iBAAK,GAAL;AACI,kBAAIoC,CAAC,KAAK,IAAV,EAAgB;AAAA;AAAA,4BAAGP,QAAH,CAAY,aAAZ,EAA2B,eAA3B;AAChB,mBAAKW,SAAL,CAAe,KAAKvC,OAApB;AACA;;AACJ,iBAAK,GAAL;AACI,kBAAImC,CAAC,KAAK,IAAV,EAAgB;AAAA;AAAA,4BAAGP,QAAH,CAAY,aAAZ,EAA2B,eAA3B;AAChB,mBAAKW,SAAL,CAAe,KAAKtC,OAApB;AACA;;AACJ,iBAAK,GAAL;AACI;AACA,mBAAKsC,SAAL,CAAe,KAAKrC,OAApB;AACA;;AACJ,iBAAK,GAAL;AACI;AACA,mBAAKqC,SAAL,CAAe,KAAKpC,OAApB;AACA;;AAEJ;AACI,oBAAM,2BAA2BiC,CAAjC;AA/BR;AAiCH;;AACDC,QAAAA,WAAW,CAACG,KAAD,EAAQ;AACf,eAAKC,MAAL,CAAYC,OAAZ,CAAoB,CAACC,GAAD,EAAMC,CAAN,KAAY;AAC5B,gBAAIA,CAAC,IAAIJ,KAAT,EAAgB;AACZG,cAAAA,GAAG,CAACnB,YAAJ,CAAiBvC,MAAjB,EAAyB4D,WAAzB,GAAuC,KAAKC,SAAL,CAAeF,CAAC,GAAG,CAAJ,GAAQ,CAAvB,CAAvC;AACH,aAFD,MAEO;AACHD,cAAAA,GAAG,CAACnB,YAAJ,CAAiBvC,MAAjB,EAAyB4D,WAAzB,GAAuC,KAAKC,SAAL,CAAeF,CAAC,GAAG,CAAnB,CAAvC;AACH;AACJ,WAND;AAOH;;AACDL,QAAAA,SAAS,CAACQ,IAAD,EAAa;AAClB,eAAKnD,UAAL,CAAgB8C,OAAhB,CAAwBM,KAAK,IAAI;AAC7B,gBAAID,IAAI,IAAIC,KAAZ,EAAmBA,KAAK,CAACnC,MAAN,GAAe,IAAf,CAAnB,KACKmC,KAAK,CAACnC,MAAN,GAAe,KAAf;AACR,WAHD;AAIH;;AACDoC,QAAAA,QAAQ,CAACd,CAAD,EAAGC,CAAH,EAAM;AACV;AAAA;AAAA,0BAAIc,eAAJ,GAAsBd,CAAtB;AACA;AAAA;AAAA,0BAAIe,MAAJ,GAFU,CAGV;AACA;AACH,SA1ImC,CA2IpC;;;AACAC,QAAAA,0BAA0B,GAAE;AACxB,eAAKC,iBAAL,CAAuBxC,MAAvB,GAAgC,IAAhC;AACH,SA9ImC,CA+IpC;;;AACAyC,QAAAA,gBAAgB,GAAE;AACd;AAAA;AAAA,wBAAG1B,QAAH,CAAY,oBAAZ,EAAiC,aAAjC;AACH;;AAlJmC,O","sourcesContent":["/*\r\n * @Author: li_jiang_wei_12345 739671694@qq.com\r\n * @Date: 2022-09-05 10:16:04\r\n * @LastEditors: li_jiang_wei 739671694@qq.com\r\n * @LastEditTime: 2022-12-10 20:49:10\r\n * @FilePath: \\to-be-immortal\\assets\\script\\mainMenu\\MainMenu.ts\r\n * @Description: \r\n * \r\n * Copyright (c) 2022 by li_jiang_wei_12345 739671694@qq.com, All Rights Reserved. \r\n */\r\nimport { _decorator, Component, Node, SpriteFrame, find, Sprite, Label, Color, Layers, director, sys, JsonAsset, native } from 'cc';\r\nimport { JSB } from 'cc/env';\r\nimport { em } from '../global/EventManager';\r\nimport { ggd } from '../global/globalData';\r\nimport { glf } from '../global/globalFun';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('MainMenu')\r\nexport class MainMenu extends Component {\r\n\r\n    @property([SpriteFrame])\r\n    selectBtnSF;\r\n    @property([Node])\r\n    btnArr\r\n    @property([SpriteFrame])\r\n    menuBtnSF;\r\n    @property(JsonAsset)\r\n    trainingLvListJson;\r\n    @property(Node)\r\n    versionNotice;\r\n    @property(Node)\r\n    gets;\r\n    @property(Node)\r\n    upgradeEquLvLayer;\r\n\r\n    _layerNode = [];\r\n\r\n    _SSLNode: Node;\r\n    _HILNode: Node;\r\n    _TLNode: Node;\r\n    _MPNode: Node;\r\n    _SBNode: Node;\r\n    _PHNode: Node;\r\n    _AINode: Node;\r\n    onDestroy() {\r\n        em.remove(\"switchMainMenuLayer\");\r\n    }\r\n    onLoad() {\r\n        em.add(\"switchMainMenuLayer\", this.onSelectBtn.bind(this));\r\n\r\n        this._SSLNode = find(\"Canvas/menuLayer/SelectStageLayer\");\r\n        this._HILNode = find(\"Canvas/menuLayer/HeroInfoLayer\");\r\n        this._TLNode = find(\"Canvas/menuLayer/TrainingLayer\");\r\n        this._MPNode = find(\"Canvas/menuLayer/MakePillsLayer\");\r\n        this._SBNode = find(\"Canvas/menuLayer/SkillBookLayer\");\r\n        this._PHNode = find(\"Canvas/menuLayer/PrizeHallLayer\");\r\n        this._AINode = find(\"Canvas/menuLayer/AddItemsLayer\");\r\n\r\n        this._layerNode.push(this._SSLNode, this._HILNode, this._TLNode, this._MPNode, this._SBNode, this._PHNode, this._AINode);\r\n        this.onSelectBtn(null, \"1\");\r\n        director.preloadScene(\"game\");\r\n        // 激活节点 注册事件\r\n        this.versionNotice.active = true;\r\n        this.versionNotice.active = false;\r\n        this.gets.active = true;\r\n        this.gets.active = false;\r\n\r\n        // em.dispatch(\"directPlayAD\",\"GameMonetize\");\r\n    }\r\n    start() {\r\n        this.initAccountInfo();\r\n        this.initLvInfo();\r\n        this.initLingshiTotal();\r\n        // let lvData = this.trainingLvListJson.json;\r\n    }\r\n    initAccountInfo() {\r\n        let accountData: any = sys.localStorage.getItem(\"loginInfo\");\r\n        if (accountData) {\r\n            accountData = JSON.parse(accountData);\r\n            find(\"Canvas/menuLayer/title/heroBaseInfoBg/nickname\").getComponent(Label).string = accountData.account;\r\n        } else {\r\n            find(\"Canvas/menuLayer/title/heroBaseInfoBg/nickname\").getComponent(Label).string = \"游客\";\r\n        }\r\n    }\r\n    initLvInfo() {\r\n        let data = em.dispatch(\"getTempData\", \"training\");//读取缓存\r\n        if (null === data) {\r\n            find(\"Canvas/menuLayer/title/heroBaseInfoBg/curLv\").getComponent(Label).string = \"江湖好手\";\r\n        } else {\r\n            let des = this.trainingLvListJson.json[data.curLv].name;\r\n            find(\"Canvas/menuLayer/title/heroBaseInfoBg/curLv\").getComponent(Label).string = des;\r\n        }\r\n    }\r\n    initLingshiTotal() {\r\n        let total = em.dispatch(\"getItemTotalByIdOrName\",\"灵石\");\r\n        find(\"Canvas/menuLayer/title/lingshiTotalBg/total\").getComponent(Label).string = total;\r\n    }\r\n\r\n\r\n\r\n    onSelectBtn(e, p) {\r\n        this.updateBtnSF(parseInt(p) - 1);\r\n        switch (p) {\r\n            case \"1\":\r\n                if (e !== null) em.dispatch(\"playOneShot\", \"common/进入试炼场\");\r\n                this.openLayer(this._SSLNode);\r\n                break;\r\n            case \"2\":\r\n                if (e !== null) em.dispatch(\"playOneShot\", \"common/点击人物界面\");\r\n                this.openLayer(this._HILNode);\r\n                break;\r\n            case \"3\":\r\n                if (e !== null) em.dispatch(\"playOneShot\", \"common/点击修行界面\");\r\n                this.openLayer(this._TLNode);\r\n                break;\r\n            case \"4\":\r\n                if (e !== null) em.dispatch(\"playOneShot\", \"common/点击炼丹界面\");\r\n                this.openLayer(this._MPNode);\r\n                break;\r\n            case \"5\":\r\n                if (e !== null) em.dispatch(\"playOneShot\", \"common/点击秘籍界面\");\r\n                this.openLayer(this._SBNode);\r\n                break;\r\n            case \"6\":\r\n                // if (e !== null) em.dispatch(\"playOneShot\", \"common/点击秘籍界面\");\r\n                this.openLayer(this._PHNode);\r\n                break;\r\n            case \"7\":\r\n                // if (e !== null) em.dispatch(\"playOneShot\", \"common/点击秘籍界面\");\r\n                this.openLayer(this._AINode);\r\n                break;\r\n\r\n            default:\r\n                throw \"p is err,current p is \" + p;\r\n        }\r\n    }\r\n    updateBtnSF(index) {\r\n        this.btnArr.forEach((btn, i) => {\r\n            if (i == index) {\r\n                btn.getComponent(Sprite).spriteFrame = this.menuBtnSF[i * 2 + 1];\r\n            } else {\r\n                btn.getComponent(Sprite).spriteFrame = this.menuBtnSF[i * 2];\r\n            }\r\n        });\r\n    }\r\n    openLayer(node: Node) {\r\n        this._layerNode.forEach(layer => {\r\n            if (node == layer) layer.active = true;\r\n            else layer.active = false;\r\n        });\r\n    }\r\n    onBtnAds(e,p) {\r\n        ggd.curAdRewardType = p;\r\n        glf.playAd();\r\n        // native.reflection.callStaticMethod(\"com/cocos/game/AppActivity\", \"createAds\", \"()V\");\r\n        // em.dispatch(\"getItemsRewardByAds\");\r\n    }\r\n    // 打开装备升阶界面\r\n    onBtnOpenUpgradeEquLvLayer(){\r\n        this.upgradeEquLvLayer.active = true;\r\n    }\r\n    // 今日签到\r\n    onBtnSignInToday(){\r\n        em.dispatch(\"usingGameRewardFun\",\"signInToday\");\r\n    }\r\n}\r\n\r\n"]}