{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Cocos/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/weapon/DoomsdayStorm.ts"],"names":["_decorator","em","ggd","tagData","Weapon","ccclass","property","DoomsdayStorm","_moveDistance","init","flyDir","_moveSpeed","addToAnimManger","_flyDir","x","y","initSkillData","data","dispatch","_damage","baseDamage","_damageTimes","damageTimes","_duration","duration","_backDis","_canAttackTimes","Infinity","_attackInterval","_weaponName","name2","initBoxCollider","sword","weaponMove","deltaTime","stopAll","dis","moveX","moveY","node","setPosition","getPosition"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,E,iBAAAA,E;;AACAC,MAAAA,G,iBAAAA,G;AAAKC,MAAAA,O,iBAAAA,O;;AACLC,MAAAA,M,iBAAAA,M;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;+BAGjBO,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,4BAC0C;AAAA;AAAA;AAAA,eACtCC,aADsC;AAAA;;AAEtCC,QAAAA,IAAI,CAACC,MAAD,EAAS;AACT,eAAKC,UAAL,GAAkB,IAAlB;AACA,eAAKH,aAAL,GAAqB,GAArB;AACA,eAAKI,eAAL;AACA,eAAKC,OAAL,GAAe;AACXC,YAAAA,CAAC,EAAEJ,MAAM,CAAC,CAAD,CADE;AAEXK,YAAAA,CAAC,EAAEL,MAAM,CAAC,CAAD;AAFE,WAAf;AAIA,eAAKM,aAAL;AACH;;AACDA,QAAAA,aAAa,GAAG;AACZ,cAAIC,IAAI,GAAG;AAAA;AAAA,wBAAGC,QAAH,CAAY,0BAAZ,EAAwC,4BAAxC,EAAsE,eAAtE,CAAX;AACA,eAAKC,OAAL,GAAeF,IAAI,CAACG,UAApB;AACA,eAAKC,YAAL,GAAoBJ,IAAI,CAACK,WAAzB;AACA,eAAKC,SAAL,GAAiBN,IAAI,CAACO,QAAtB;AACA,eAAKC,QAAL,GAAgB,CAAhB;AACA,eAAKC,eAAL,GAAuBC,QAAvB;AACA,eAAKC,eAAL,GAAuB,GAAvB;AACA,eAAKC,WAAL,GAAmBZ,IAAI,CAACa,KAAxB,CARY,CASZ;;AACA,eAAKC,eAAL,CAAqB;AAAA;AAAA,kCAAQC,KAA7B;AACH;;AACDC,QAAAA,UAAU,CAACC,SAAD,EAAoB;AAC1B;AACA,cAAI;AAAA;AAAA,0BAAIC,OAAR,EAAiB;AACjB,cAAI,CAAC,KAAKtB,OAAV,EAAmB;;AACnB,cAAI,KAAKL,aAAL,IAAsB,CAA1B,EAA6B;AACzB;AACA;AACA;AACH;;AACD,cAAI,KAAKG,UAAL,IAAmB,CAAvB,EAA0B;AAC1B,cAAIyB,GAAG,GAAGF,SAAS,GAAG,KAAKvB,UAA3B,CAV0B,CAW1B;;AACA,cAAI0B,KAAK,GAAG,KAAKxB,OAAL,CAAaC,CAAb,GAAiBsB,GAA7B;AACA,cAAIE,KAAK,GAAG,KAAKzB,OAAL,CAAaE,CAAb,GAAiBqB,GAA7B;AACA,eAAKG,IAAL,CAAUC,WAAV,CAAsB,KAAKD,IAAL,CAAUE,WAAV,GAAwB3B,CAAxB,GAA4BuB,KAAlD,EAAyD,KAAKE,IAAL,CAAUE,WAAV,GAAwB1B,CAAxB,GAA4BuB,KAArF,EAA4F,CAA5F;AACA,eAAK9B,aAAL,IAAsB4B,GAAtB;AACH;;AAxCqC,O","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nimport { em } from '../../global/EventManager';\r\nimport { ggd, tagData } from '../../global/globalData';\r\nimport { Weapon } from './Weapon';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('DoomsdayStorm')\r\nexport class DoomsdayStorm extends Weapon {\r\n    _moveDistance: number;\r\n    init(flyDir) {\r\n        this._moveSpeed = 1000;\r\n        this._moveDistance = 300;\r\n        this.addToAnimManger();\r\n        this._flyDir = {\r\n            x: flyDir[0],\r\n            y: flyDir[1]\r\n        }\r\n        this.initSkillData();\r\n    }\r\n    initSkillData() {\r\n        let data = em.dispatch(\"usingHeroBasePropertyFun\", \"getSkillBookDataByIdOrName\", \"doomsdayStorm\");\r\n        this._damage = data.baseDamage;\r\n        this._damageTimes = data.damageTimes;\r\n        this._duration = data.duration;\r\n        this._backDis = 0;\r\n        this._canAttackTimes = Infinity;\r\n        this._attackInterval = 0.3;\r\n        this._weaponName = data.name2;\r\n        // this.clearCacheData();\r\n        this.initBoxCollider(tagData.sword);\r\n    }\r\n    weaponMove(deltaTime: number) {\r\n        // return;\r\n        if (ggd.stopAll) return;\r\n        if (!this._flyDir) return;\r\n        if (this._moveDistance <= 0) {\r\n            // this.playDestroyAnim();\r\n            // 进入停留5s后消失\r\n            return;\r\n        }\r\n        if (this._moveSpeed == 0) return;\r\n        let dis = deltaTime * this._moveSpeed;\r\n        // let dis = deltaTime*(this._moveSpeed+bonusMS);\r\n        let moveX = this._flyDir.x * dis;\r\n        let moveY = this._flyDir.y * dis;\r\n        this.node.setPosition(this.node.getPosition().x + moveX, this.node.getPosition().y + moveY, 0);\r\n        this._moveDistance -= dis;\r\n    }\r\n}\r\n\r\n"]}