{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Cocos/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/Puppet.ts"],"names":["_decorator","Component","BoxCollider2D","Sprite","find","em","ccclass","property","Puppet","_maxBlood","_curBlood","initNodeCallBack","node","updateBloodProgress","bind","initBoxCollider","tag","group","collider","getComponent","addComponent","changeValue","console","log","puppetDied","sprite","fillRange","dispatch","destroy"],"mappings":";;;;;;;;;;;;;;;;AAUSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,a,OAAAA,a;AAA8BC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,I,OAAAA,I;;AACnEC,MAAAA,E,iBAAAA,E;;;;;;AAXT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;OAIM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;wBAGjBQ,M,WADZF,OAAO,CAAC,QAAD,C,gBAAR,MACaE,MADb,SAC4BP,SAD5B,CACsC;AAAA;AAAA;AAAA,eAElCQ,SAFkC;AAAA,eAGlCC,SAHkC;AAAA;;AAIlC;AACAC,QAAAA,gBAAgB,GAAE;AACd,eAAKC,IAAL,CAAUC,mBAAV,GAAgC,KAAKA,mBAAL,CAAyBC,IAAzB,CAA8B,IAA9B,CAAhC,CADc,CAEd;;AACA,eAAKD,mBAAL,CAAyB,CAAzB;AACH;;AACDE,QAAAA,eAAe,CAACC,GAAD,EAAcC,KAAd,EAA4B;AACvC,cAAI,CAACD,GAAL,EAAU,MAAM,WAAWA,GAAjB,CAD6B,CAEvC;;AACA,cAAIE,QAAQ,GAAG,KAAKN,IAAL,CAAUO,YAAV,CAAuBjB,aAAvB,CAAf;AACA,cAAI,CAACgB,QAAL,EAAeA,QAAQ,GAAG,KAAKN,IAAL,CAAUQ,YAAV,CAAuBlB,aAAvB,CAAX;AACfgB,UAAAA,QAAQ,CAACF,GAAT,GAAeA,GAAf;AACAE,UAAAA,QAAQ,CAACD,KAAT,GAAiBA,KAAjB,CANuC,CAOvC;AACA;AACA;AACH,SApBiC,CAqBlC;;;AACAJ,QAAAA,mBAAmB,CAACQ,WAAD,EAAsB;AACrC;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAqBF,WAArB;AACA,eAAKX,SAAL,IAAkBW,WAAlB;;AACA,cAAI,KAAKX,SAAL,GAAiB,CAArB,EAAwB;AACpB,iBAAKA,SAAL,GAAiB,CAAjB;AACA,iBAAKc,UAAL;AACH;;AAAA;AACD,cAAI,KAAKd,SAAL,GAAiB,KAAKD,SAA1B,EAAqC,KAAKC,SAAL,GAAiB,KAAKD,SAAtB;AACrC,cAAIgB,MAAM,GAAGrB,IAAI,CAAC,+BAAD,EAAiC,KAAKQ,IAAtC,CAAJ,CAAgDO,YAAhD,CAA6DhB,MAA7D,CAAb;AACAsB,UAAAA,MAAM,CAACC,SAAP,GAAmB,KAAKhB,SAAL,GAAiB,KAAKD,SAAzC;AACAa,UAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA6B,KAAKb,SAAlC;AACAY,UAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA6B,KAAKd,SAAlC;AACH,SAnCiC,CAoClC;;;AACAe,QAAAA,UAAU,GAAE;AACRF,UAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACA;AAAA;AAAA,wBAAGI,QAAH,CAAY,qBAAZ,EAAkC,iBAAlC;AACA,eAAKf,IAAL,CAAUgB,OAAV;AACH;;AAzCiC,O","sourcesContent":["/*\r\n * @Author: li_jiang_wei_12345 739671694@qq.com\r\n * @Date: 2022-11-23 10:38:29\r\n * @LastEditors: li_jiang_wei_12345 739671694@qq.com\r\n * @LastEditTime: 2022-11-23 16:22:23\r\n * @FilePath: \\to-be-immortal\\assets\\script\\hero\\Puppet.ts\r\n * @Description:\r\n * \r\n * Copyright (c) 2022 by li_jiang_wei_12345 739671694@qq.com, All Rights Reserved. \r\n */\r\nimport { _decorator, Component, Node, BoxCollider2D, Contact2DType, Sprite, find } from 'cc';\r\nimport { em } from '../global/EventManager';\r\nimport { groupIndex } from '../global/globalData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Puppet')\r\nexport class Puppet extends Component {\r\n\r\n    _maxBlood:number;\r\n    _curBlood:number;\r\n    //在node上直接添加回调，方便调用\r\n    initNodeCallBack(){\r\n        this.node.updateBloodProgress = this.updateBloodProgress.bind(this);\r\n        // this.node.updateBloodProgress = this.updateBloodProgress;\r\n        this.updateBloodProgress(0);\r\n    }\r\n    initBoxCollider(tag: number, group:number) {\r\n        if (!tag) throw \"tag is\" + tag;\r\n        // let collider = this.node.addComponent(BoxCollider2D);\r\n        let collider = this.node.getComponent(BoxCollider2D);\r\n        if (!collider) collider = this.node.addComponent(BoxCollider2D);\r\n        collider.tag = tag;\r\n        collider.group = group;\r\n        // console.log(\"collider\", collider);\r\n        // collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n        // collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n    }\r\n    //刷新血条\r\n    updateBloodProgress(changeValue: number) {\r\n        // console.log(\"刷新血条，changeValue\", changeValue);\r\n        console.log(\"刷新傀儡血条\",changeValue);\r\n        this._curBlood += changeValue;\r\n        if (this._curBlood < 0) {\r\n            this._curBlood = 0;\r\n            this.puppetDied();\r\n        };\r\n        if (this._curBlood > this._maxBlood) this._curBlood = this._maxBlood;\r\n        let sprite = find(\"bloodProgressBg/bloodProgress\",this.node).getComponent(Sprite);\r\n        sprite.fillRange = this._curBlood / this._maxBlood;\r\n        console.log(\"this._curBlood\",this._curBlood);\r\n        console.log(\"this._maxBlood\",this._maxBlood);\r\n    }\r\n    // 傀儡死亡\r\n    puppetDied(){\r\n        console.log(\"傀儡死亡\");\r\n        em.dispatch(\"usingHeroControlFun\",\"resetHeroPuppet\");\r\n        this.node.destroy();\r\n    }\r\n}\r\n\r\n"]}