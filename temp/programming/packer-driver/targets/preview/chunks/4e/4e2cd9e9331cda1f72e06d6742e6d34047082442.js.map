{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Cocos/ZA/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/system/StorageSpace.ts"],"names":["_decorator","Component","JsonAsset","find","director","em","ItemManger","ccclass","property","StorageSpace","_itemData","_IM","onDestroy","remove","onLoad","add","addItemToSS","bind","reduceItemFromSS","itemIsEnough","itemIsValid","getItemList","getItemDataByIdOrName","getItemTotalByIdOrName","getAllPills","getItemsRewardByAds","initItemData","addPersistRootNode","node","all","itemDataJson","json","forEach","element","id","name","showAll","console","log","initSSData","data","dispatch","key","Object","prototype","hasOwnProperty","call","addItem","parseInt","start","addSomeItems","helpAddItems","helpAddItems2","i","id_name","total","result","reduceItem","_itemList","getItemTotal","list","type2","t1","t2","Math","random","curLv","tips","ssNode","active","script","getComponent","updateStorageSpace"],"mappings":"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","sourcesContent":["/*\r\n * @Author: li_jiang_wei_12345 739671694@qq.com\r\n * @Date: 2022-09-06 17:34:04\r\n * @LastEditors: li_jiang_wei 739671694@qq.com\r\n * @LastEditTime: 2022-12-14 23:54:12\r\n * @FilePath: \\to-be-immortal\\assets\\script\\system\\StorageSpace.ts\r\n * @Description: \r\n * \r\n * Copyright (c) 2022 by li_jiang_wei_12345 739671694@qq.com, All Rights Reserved. \r\n */\r\nimport { _decorator, Component, Node, JsonAsset, game, find, Label, director } from 'cc';\r\nimport { em } from '../global/EventManager';\r\nimport { ItemManger } from './ItemManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('StorageSpace')\r\nexport class StorageSpace extends Component {\r\n    @property(JsonAsset)\r\n    itemDataJson;\r\n\r\n    _itemData = {};\r\n    _IM: ItemManger;\r\n    onDestroy() {\r\n        em.remove(\"addItemToSS\");\r\n        em.remove(\"reduceItemFromSS\");\r\n        em.remove(\"itemIsEnough\");\r\n        em.remove(\"itemIsValid\");\r\n        em.remove(\"getItemList\");\r\n        em.remove(\"getItemDataByIdOrName\");\r\n        em.remove(\"getItemTotalByIdOrName\");\r\n        em.remove(\"getAllPills\");\r\n        em.remove(\"getItemsRewardByAds\");\r\n    }\r\n    onLoad() {\r\n        em.add(\"addItemToSS\", this.addItemToSS.bind(this));\r\n        em.add(\"reduceItemFromSS\", this.reduceItemFromSS.bind(this));\r\n        em.add(\"itemIsEnough\", this.itemIsEnough.bind(this));\r\n        em.add(\"itemIsValid\", this.itemIsValid.bind(this));\r\n        em.add(\"getItemList\", this.getItemList.bind(this));\r\n        em.add(\"getItemDataByIdOrName\", this.getItemDataByIdOrName.bind(this));\r\n        em.add(\"getItemTotalByIdOrName\", this.getItemTotalByIdOrName.bind(this));\r\n        em.add(\"getAllPills\", this.getAllPills.bind(this));\r\n        em.add(\"getItemsRewardByAds\", this.getItemsRewardByAds.bind(this));\r\n        this.initItemData();\r\n        this._IM = new ItemManger();\r\n        // this.schedule(this.showAll,1);\r\n        director.addPersistRootNode(this.node);//背包物品在各个场景皆可用到 设置为常驻节点\r\n    }\r\n    initItemData() {\r\n        let all = this.itemDataJson.json;\r\n        all.forEach(element => {\r\n            let id = element.id;\r\n            let name = element.name;\r\n            this._itemData[id] = element;\r\n            this._itemData[name] = element;\r\n        });\r\n        // console.log(\"_itemData\",this._itemData);\r\n    }\r\n    showAll() {\r\n        console.log(\"_IM\", this._IM);\r\n    }\r\n    //初始化仓库数据\r\n    initSSData() {\r\n        let data = em.dispatch(\"getTempData\", \"storageSpace\");//读取缓存\r\n        if (null !== data) {\r\n            for (const key in data) {\r\n                if (Object.prototype.hasOwnProperty.call(data, key)) {\r\n                    const element = data[key];\r\n                    // this.addItemToSS(key, element, false);\r\n                    this._IM.addItem(parseInt(key), element);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    start() {\r\n        this.initSSData();\r\n        this.addSomeItems();\r\n\r\n        // this.helpAddItems();\r\n        // this.helpAddItems2();\r\n\r\n    }\r\n    // 添加某些物品\r\n    addSomeItems() {\r\n        // this.addItemToSS(\"灵石\", 10);\r\n        // this.addItemToSS( \"迷踪步\",2);\r\n        // this.addItemToSS( \"万剑归冢\",2);\r\n        // this.addItemToSS( \"一阶宝箱\",999);\r\n        // this.addItemToSS( \"二阶宝箱\",999);\r\n        // this.addItemToSS( \"三阶宝箱\",999);\r\n        // this.addItemToSS( \"四阶宝箱\",999);\r\n        // this.addItemToSS(\"凝气术\", 2);\r\n        // this.addItemToSS(\"怒狮狂吼\", 2);\r\n        // this.addItemToSS(\"冰锥术\", 2);\r\n        // this.addItemToSS(\"剑雨术\", 2);\r\n        // this.addItemToSS(\"冰河世纪\", 2);\r\n        // this.addItemToSS(\"一剑隔世\", 2);\r\n        // this.addItemToSS(\"万剑归冢\", 2);\r\n        // this.addItemToSS(\"炼气丹\", 5000);\r\n\r\n        // this.addItemToSS(\"移形换影\", 1);\r\n        // this.addItemToSS(\"火行步\", 1);\r\n        // this.addItemToSS(\"飞雷神\", 1);\r\n        // this.addItemToSS(\"末日风暴\", 1);\r\n        // this.addItemToSS(\"八面危风\", 1);\r\n        // this.addItemToSS(\"如沐春风\", 1);\r\n        // this.addItemToSS(\"如沐春风\", 1);\r\n        // this.addItemToSS(\"灵风指\", 1);\r\n        // this.addItemToSS(\"御风术\", 1);\r\n        // this.addItemToSS(\"仙风云体\", 1);\r\n\r\n        // this.addItemToSS(\"化神丹\", 99);\r\n    }\r\n    //辅助函数 用户测试添加物品\r\n    helpAddItems() {\r\n        this.addItemToSS(\"一阶宝箱\", 99);\r\n        this.addItemToSS(\"二阶宝箱\", 99);\r\n        this.addItemToSS(\"三阶宝箱\", 99);\r\n        this.addItemToSS(\"四阶宝箱\", 99);\r\n        this.addItemToSS(\"五阶宝箱\", 99);\r\n        this.addItemToSS(\"一阶功法残卷\", 99);\r\n        this.addItemToSS(\"一阶功法整卷\", 99);\r\n    }\r\n    // 为n种物品添加m个\r\n    helpAddItems2() {\r\n        for (let i = 1; i < 75; i++) {\r\n            // this.addItemToSS(i,1000);\r\n            this.addItemToSS(i, 100);\r\n        };\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * @description: 通过id 或 name 获取物品属性 \r\n     * @param {*} id_name 物品 id 或 name\r\n     */\r\n    getItemDataByIdOrName(id_name) {\r\n        if (this._itemData.hasOwnProperty(id_name)) return this._itemData[id_name];\r\n        else throw id_name + \" of _itemData is null\";\r\n    }\r\n    //判断物品id或名称是否有效\r\n    itemIsValid(id_name){\r\n        return this._itemData.hasOwnProperty(id_name);\r\n    }\r\n    //默认记录 添加的物品 isSaving = true；当初始化添加物品时\r\n    addItemToSS(id_name, total: number) {\r\n        if (!this._itemData.hasOwnProperty(id_name)) throw \"id_name err,id is \" + id_name + \" item is err\";\r\n        let id = this._itemData[id_name].id;\r\n        this._IM.addItem(id, total);\r\n        em.dispatch(\"savingToTempData\", \"storageSpace\", this.getItemList());\r\n\r\n    }\r\n    reduceItemFromSS(id_name, total: number) {\r\n        if (!this._itemData.hasOwnProperty(id_name)) throw \"id_name err,id_name is \" + id_name + \" item is err\";\r\n        let id = this._itemData[id_name].id;\r\n        let result = this._IM.reduceItem(id, total);\r\n        em.dispatch(\"savingToTempData\", \"storageSpace\", this.getItemList());\r\n        return result;\r\n    }\r\n    itemIsEnough(id_name, total: number) {\r\n        if (!this._itemData.hasOwnProperty(id_name)) throw \"id_name err,id_name is \" + id_name + \" item is err\";\r\n        let id = this._itemData[id_name].id;\r\n        return this._IM.itemIsEnough(id, total);\r\n    }\r\n    getItemList() {\r\n        return this._IM._itemList;\r\n    }\r\n    //获取指定id 或 名称的物品 的数量\r\n    getItemTotalByIdOrName(id_name) {\r\n        // console.log(\"getItemTotalByIdOrName\",id_name);\r\n        // console.log(\"this._itemData\",this._itemData);\r\n        if (!this._itemData.hasOwnProperty(id_name)) throw id_name + \" of _itemData is null\";\r\n        let id = this._itemData[id_name].id;\r\n        return this._IM.getItemTotal(id);\r\n    }\r\n    //获取已拥有的 所有丹药\r\n    getAllPills() {\r\n        let list = {};\r\n        for (const id in this._IM._itemList) {\r\n            if (Object.prototype.hasOwnProperty.call(this._IM._itemList, id)) {\r\n                if (this._itemData[id].type2 == \"丹药\") {\r\n                    list[id] = this._IM._itemList[id];\r\n                };\r\n            }\r\n        }\r\n        return list;\r\n    }\r\n    //通过广告获取物品奖励\r\n    getItemsRewardByAds() {\r\n        let data = em.dispatch(\"getTempData\", \"training\");//读取缓存\r\n        let t1 = 1;\r\n        let t2 = 5+Math.random()*5|0;//最少5个 最多10个妖丹\r\n        if (!data||data.curLv < 5) {\r\n            this.addItemToSS(\"一阶宝箱\", t1);\r\n            this.addItemToSS(\"炼气丹\", t2);\r\n            let tips = \"获得物品：一阶宝箱x\"+t1+\"、炼气丹x\"+t2;\r\n            em.dispatch(\"tipsViewShow\", tips);\r\n        } else if (data.curLv < 15) {\r\n            this.addItemToSS(\"二阶宝箱\", t1);\r\n            this.addItemToSS(\"筑基丹\", t2);\r\n            let tips = \"获得物品：二阶宝箱x\"+t1+\"筑基丹x\"+t2;\r\n            em.dispatch(\"tipsViewShow\", tips);\r\n        } else if (data.curLv < 31) {\r\n            this.addItemToSS(\"三阶宝箱\", t1);\r\n            this.addItemToSS(\"金元丹\", t2);\r\n            let tips = \"获得物品：三阶宝箱x\"+t1+\"金元丹x\"+t2;\r\n            em.dispatch(\"tipsViewShow\", tips);\r\n        } else if (data.curLv < 47) {\r\n            this.addItemToSS(\"四阶宝箱\", t1);\r\n            this.addItemToSS(\"元婴丹\", t2);\r\n            let tips = \"获得物品：四阶宝箱x\"+t1+\"元婴丹x\"+t2;\r\n            em.dispatch(\"tipsViewShow\", tips);\r\n        } else {\r\n            this.addItemToSS(\"五阶宝箱\", t1);\r\n            this.addItemToSS(\"化神丹\", t2);\r\n            let tips = \"获得物品：五阶宝箱x\"+t1+\"化神丹x\"+t2;\r\n            em.dispatch(\"tipsViewShow\", tips);\r\n        };\r\n        let ssNode = find(\"Canvas/menuLayer/HeroInfoLayer/storageSpace\");\r\n        if(ssNode.active){\r\n            let script:any = find(\"Canvas/menuLayer/HeroInfoLayer\").getComponent(\"HeroInfoLayer\");\r\n            script.updateStorageSpace();\r\n        }\r\n    }\r\n}\r\n\r\n"]}