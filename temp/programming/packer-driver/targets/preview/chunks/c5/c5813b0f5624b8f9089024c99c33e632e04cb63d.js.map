{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Cocos/ZA/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/weapon/Thundercloud.ts"],"names":["_decorator","em","ggd","tagData","Weapon","ccclass","property","Thundercloud","init","_moveSpeed","dispatch","addToAnimManger","initSkillData","data","_damage","baseDamage","_damageTimes","damageTimes","_duration","duration","_backDis","_canAttackTimes","Infinity","_attackInterval","_weaponName","name2","changeSize","x","y","initBoxCollider","sword","recoveryToPool","removeAnimFromList","node","destroy","weaponMove","dt","stopAll","targetPos","curPos","getWorldPosition","dis","Math","sqrt","time","moveDisX","moveDisY","setWorldPosition","colliderMonster","other","isStopRun","updateMonsterBlood","random","script","getComponent","addDebuffParalysis"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nimport { em } from '../../global/EventManager';\r\nimport { ggd, tagData } from '../../global/globalData';\r\nimport { Weapon } from './Weapon';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Thundercloud')\r\nexport class Thundercloud extends Weapon {\r\n    init() {\r\n        this._moveSpeed = em.dispatch(\"usingHeroControlFun\", \"getCurMoveSpeed\") * 0.9;\r\n        this.addToAnimManger();\r\n        this.initSkillData();\r\n    }\r\n    initSkillData() {\r\n        let data = em.dispatch(\"usingHeroBasePropertyFun\", \"getSkillBookDataByIdOrName\", \"thundercloud\");\r\n        this._damage = data.baseDamage;\r\n        this._damageTimes = data.damageTimes;\r\n        this._duration = data.duration;\r\n        this._backDis = 0;\r\n        this._canAttackTimes = Infinity;\r\n        this._attackInterval = 0.3;\r\n        this._weaponName = data.name2;\r\n        // this.clearCacheData();\r\n        let changeSize = {\r\n            x: -30,\r\n            y: -50\r\n        }\r\n        this.initBoxCollider(tagData.sword, changeSize);\r\n    }\r\n    recoveryToPool() {\r\n        this.removeAnimFromList();\r\n        this.node.destroy();\r\n    }\r\n    weaponMove(dt) {\r\n        // return\r\n        if (ggd.stopAll) return;\r\n        let targetPos = em.dispatch(\"getTargetWorldPos\");\r\n        let curPos = this.node.getWorldPosition();\r\n        let x = targetPos.x - curPos.x;\r\n        let y = targetPos.y - curPos.y;\r\n        let dis = Math.sqrt(x * x + y * y);\r\n        let time = this._moveSpeed == 0 ? 0 : dis / this._moveSpeed;\r\n        let moveDisX = (time == 0 ? 0 : dt / time * x);\r\n        let moveDisY = (time == 0 ? 0 : dt / time * y);\r\n        this.node.setWorldPosition(curPos.x + moveDisX, curPos.y + moveDisY, 0);\r\n    }\r\n    colliderMonster(other) {\r\n        if (this.isStopRun(other)) return;\r\n        this.updateMonsterBlood(other);\r\n        if (Math.random() < 0.2) {\r\n            let script = other.node.getComponent(\"Monster\");\r\n            if (script) script.addDebuffParalysis(5);\r\n        }\r\n\r\n    }\r\n}\r\n\r\n"]}