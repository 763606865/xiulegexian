{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/TSGFDemo/Demo/%E4%BF%AE%E4%BA%86%E4%B8%AA%E4%BB%99/assets/script/hero/equSystem/GiantAxe.ts"],"names":["_decorator","Animation","em","plm","Weapon","ccclass","property","GiantAxe","init","initEquData","clearCacheData","addToAnimManger","heroDir","dispatch","console","log","dir","x","y","_flyDir","data","qData","effect","indexOf","node","getComponent","play","_damage","lData","baseDamage","_damageTimes","damageTimes","_duration","Infinity","_moveSpeed","_backDis","_attackInterval","_canAttackTimes","_weaponName","initEquDataByExtraProperties","recoveryToPool","removeAnimFromList","putToPool","createShockWaveBy1006or1007","wp","getWorldPosition","createShockWaveBy5005","type"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Animation } from 'cc';\r\nimport { em } from '../../global/EventManager';\r\nimport { plm } from '../../global/PoolManager';\r\nimport { Weapon } from '../weapon/Weapon';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GiantAxe')\r\nexport class GiantAxe extends Weapon {\r\n\r\n    init() {\r\n        this.initEquData();\r\n        this.clearCacheData();\r\n        this.addToAnimManger();\r\n        let heroDir = em.dispatch(\"getHeroControlProperty\", \"_curDirection\");\r\n        console.log(\"heroDir\", heroDir);\r\n        let dir = {\r\n            x: heroDir.x,\r\n            y: heroDir.y,\r\n        }\r\n        this._flyDir = dir;\r\n        // this._flyDir.x = dir.x;\r\n        // this._flyDir.y = dir.y;\r\n        let data = em.dispatch(\"usingHeroBasePropertyFun\", \"getCurHeroUsingWeaponData\");\r\n        if (this._flyDir.x > 0) {\r\n            if (data.qData.effect.indexOf(5005) > -1) this.node.getComponent(Animation).play(\"giantAxeR2\");\r\n            else this.node.getComponent(Animation).play(\"giantAxeR\");\r\n        }else{\r\n            if (data.qData.effect.indexOf(5005) > -1) this.node.getComponent(Animation).play(\"giantAxeL2\");\r\n            else this.node.getComponent(Animation).play(\"giantAxeL\");\r\n        } \r\n\r\n    }\r\n    initEquData() {\r\n        let data = em.dispatch(\"usingHeroBasePropertyFun\", \"getCurHeroUsingWeaponData\");\r\n        this._damage = data.lData.baseDamage;\r\n        this._damageTimes = data.lData.damageTimes;\r\n\r\n        this._duration = Infinity;\r\n        this._moveSpeed = 0;\r\n        this._backDis = 150;\r\n        this._attackInterval = 2;\r\n        this._canAttackTimes = Infinity;\r\n        this._weaponName = \"rotationAxe\";\r\n\r\n        this.initEquDataByExtraProperties(data);\r\n\r\n    }\r\n    recoveryToPool() {\r\n        this.removeAnimFromList();\r\n        plm.putToPool(this._weaponName, this.node);\r\n    }\r\n    // 创建冲击波 通过1006和1007词条\r\n    createShockWaveBy1006or1007() {\r\n        let data = em.dispatch(\"usingHeroBasePropertyFun\", \"getCurHeroUsingWeaponData\");\r\n        if (data.qData.effect.indexOf(1006) > -1 || data.qData.effect.indexOf(1007) > -1) {\r\n            let wp = this.node.getWorldPosition();\r\n            em.dispatch(\"usingWeaponManagerFun\", \"createShockWave\", wp, this._flyDir);\r\n        }\r\n    }\r\n    //创建冲击波\r\n    createShockWaveBy5005(type) {\r\n        let wp = this.node.getWorldPosition();\r\n        if (type == 1) {\r\n            em.dispatch(\"usingWeaponManagerFun\", \"createShockWave\", wp, this._flyDir);\r\n        } else {\r\n            em.dispatch(\"usingWeaponManagerFun\", \"createShockWave\", wp, { x: -this._flyDir.x, y: this._flyDir.y });\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}